<!-- <section id="analytics">
	<div class="col-12 border-1 bg-primary p-3">
		<p>profile-view works!</p>
	</div>
</section> -->
<!-- Encabezado -->


  

<div class="row border-2">
	<div class="col-12 text-start">
		<h1 class="mb-3"><i class="bi bi-person-circle"></i> Perfil de Usuario</h1>
		<nav aria-label="breadcrumb" class="bg-body-tertiary rounded-3 p-3 mb-4">
			<ol class="breadcrumb mb-0">
				<li class="breadcrumb-item"><a [routerLink]="['/dashboard', 'analytics']">Home</a></li>
				<li class="breadcrumb-item"><a [routerLink]="['/dashboard', 'profile', uid, 'view']">Profile</a></li>
				<li class="breadcrumb-item active" aria-current="page">Profile view</li>
			</ol>
		</nav>
	</div>
</div>

<div class="row">
	<div class="col">
		<div *ngIf="isLoading" class="text-center my-5">
			<div class="spinner-border text-primary" role="status">
				<span class="visually-hidden">Cargando...</span>
			</div>
			</div>
	</div>
</div>


<div class="row">
	<div class="col-12 my-3">
		<a class="btn btn-primary mx-2" [routerLink]="['/dashboard', 'profile', uid, 'view']">Ver perfil</a>
		<a class="btn btn-primary mx-2" [routerLink]="['/dashboard', 'profile', uid, 'edit']">Editar perfil</a>
	</div>
</div>

<section class="border-2" style="background-color: #f6f6f6;">
	<!-- <div class="container py-5"> -->
		<div class="row">
			<div id="border-1" class="col-lg-4">
				<div class="card mb-4">
					<div class="card-body text-center">
						<div class="position-relative d-inline-block">
						<!-- <img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava3.webp" alt="avatar"
							class="rounded-circle img-fluid" style="width: 150px;"> -->
							<img [src]="perfil?.photoURL || defaultImage " class="rounded-circle profile-pic" alt="Profile Picture" width="120"
								height="120" />
							<input type="file" accept="image/*" (change)="onFileSelected($event)" hidden #fileInput />
							<button class="btn btn-primary btn-sm position-absolute bottom-0 end-0 rounded-circle" (click)="fileInput.click()">
								<i class="fas fa-camera"></i>
							</button>
						</div>
						<h5 class="my-2">{{ perfil?.name + ' ' + perfil?.last_name }}</h5>
						<p class="text-muted mb-1"><span class="badge bg-primary-subtle text-primary px-3 py-2 rounded-pill">{{perfil?.profession}}</span></p>
						<p class="text-muted mb-2">{{perfil?.address}}, {{perfil?.city}}</p>
						<p class="mb-4"><span class="badge bg-success-subtle text-dark px-3 py-2 rounded-pill">
								{{ perfil?.uid }}
							</span></p>
						<div class="d-flex justify-content-center mb-2">
							<button type="button" data-mdb-button-init data-mdb-ripple-init class="btn btn-primary">Follow</button>
							<button type="button" data-mdb-button-init data-mdb-ripple-init
								class="btn btn-outline-primary ms-1">Message</button>
						</div>
					</div>
				</div>
				<div class="card mb-4 mb-lg-0">
					<div class="card-body p-0">
						<ul class="list-group list-group-flush rounded-3">
							<li class="list-group-item d-flex justify-content-between align-items-center p-3">
								<i class="fas fa-globe fa-lg text-warning"></i>
								<p class="mb-0">{{perfil?.website || 'N/A'}}</p>
							</li>
							<li class="list-group-item d-flex justify-content-between align-items-center p-3">
								<i class="fab fa-github fa-lg text-body"></i>
								<p class="mb-0">{{perfil?.github}}</p>
							</li>
							<li class="list-group-item d-flex justify-content-between align-items-center p-3">
								<i class="fab fa-twitter fa-lg" style="color: #55acee;"></i>
								<p class="mb-0">{{perfil?.twitter}}</p>
							</li>
							<li class="list-group-item d-flex justify-content-between align-items-center p-3">
								<i class="fab fa-instagram fa-lg" style="color: #ac2bac;"></i>
								<p class="mb-0">{{perfil?.instagram}}</p>
							</li>
							<li class="list-group-item d-flex justify-content-between align-items-center p-3">
								<i class="fab fa-facebook-f fa-lg" style="color: #3b5998;"></i>
								<p class="mb-0">{{perfil?.facebook}}</p>
							</li>
						</ul>
					</div>
				</div>
			</div>
			<div id="border-1" class="col-lg-8">
				<div class="card mb-4">
					<div class="card-body">						
						<form [formGroup]="profileUserForm" (ngSubmit)="saveProfile()">
							<!-- uid -->
								<div class="mb-3">
									<label for="uid" class="form-label">UID</label>
									<input type="text" id="uid" class="form-control" formControlName="uid" [readonly]="!editMode">
								</div>

								<div class="row mb-3">
									<label for="staticEmail" class="col-sm-3 col-form-label">Email</label>
									<div class="col-sm-9">
										<input type="text" readonly class="form-control-plaintext" id="staticEmail" value="email@example.com">
									</div>
								</div>

								<div class="row mb-3">
									<label for="inputPassword" class="col-sm-2 col-form-label">Password</label>
									<div class="col-sm-10">
										<input type="password" class="form-control" id="inputPassword">
									</div>		
								</div>

								  
								<div class="row mb-3">
									<label for="photoURL" class="col-sm-3 col-form-label">URL de la foto de perfil</label>
									<div class="col-sm-9">
										<input id="photoURL" type="url" class="form-control" formControlName="photoURL" placeholder="https://..."
										[readonly]="!editMode" />
										<div class="form-text text-end">Pega una URL de imagen pública (por ejemplo desde <a href="https://imgur.com/upload" target="_blank">Imgur</a>)</div>
									</div>
								</div>

								<div class="row mb-3">
									<label for="name" class="col-sm-3 col-form-label">Nombres</label>
									<div class="col-sm-9">
										<input type="text" id="name" class="form-control" formControlName="name" [readonly]="!editMode">
									</div>
								</div>

								<div class="row mb-3">
									<label for="last_name" class="col-sm-3 col-form-label">Apellidos</label>
									<div class="col-sm-9">
										<input type="text" id="last_name" class="form-control" formControlName="last_name" [readonly]="!editMode">
									</div>
								</div>

								<div class="row mb-3">
									<label for="user_name" class="col-sm-3 col-form-label">Nombre Usuario</label>
									<div class="col-sm-9">
										<input type="text" id="user_name" class="form-control" formControlName="user_name" [readonly]="!editMode">
									</div>
								</div>

								<div class="row mb-3">
									<label for="email" class="col-sm-3 col-form-label">Email</label>
									<div class="col-sm-9">
										<input type="email" id="email" class="form-control" formControlName="email" [readonly]="!editMode">
									</div>
								</div>
						</form>
					</div>
				</div>
			</div>
		</div>
	<!-- </div> -->
</section>


<form [formGroup]="profileForm" (ngSubmit)="saveProfile()">
	<div class="container py-4">
		<div class="row g-3 text-start">

			<!-- Foto de perfil -->
			<hr class="my-1">

			<div class="col-12 p-4 mb-1 ">

				<div class="d-flex align-items-center mb-4 mb-lg-0">
					<div class="position-relative d-inline-block">
						<!-- <img src="https://randomuser.me/api/portraits/men/40.jpg" class="rounded-circle profile-pic" alt="Profile Picture"> -->
						<img [src]="perfil?.photoURL || defaultImage " class="rounded-circle profile-pic" alt="Profile Picture"
							width="120" height="120" />
						<input type="file" accept="image/*" (change)="onFileSelected($event)" hidden #fileInput />
						<button class="btn btn-primary btn-sm position-absolute bottom-0 end-0 rounded-circle"
							(click)="fileInput.click()">
							<i class="fas fa-camera"></i>
						</button>
					</div>
					<div class="ms-3">
						<h4 class="mb-0">{{ perfil?.user_name }}</h4>
						<p class=" mb-0">PNG o JPG no mayor a 800 px de ancho y alto.</p>
					</div>
				</div>

			</div>


			<hr class="my-2">

			<div class="col-12">
				<span class="badge bg-primary-subtle text-primary px-3 py-2 rounded-pill">
					{{ perfil?.profession }}
				</span>
			</div>



			<div class="col-6">
				<!-- uid -->
				<div class="mb-3 ">
					<label for="uid" class="form-label">UID</label>
					<input type="text" id="uid" class="form-control" formControlName="uid" [readonly]="!editMode">
				</div>
			</div>

			<div class="col-6">
				<div class="mb-3">
					<label for="photoURL" class="form-label">URL de la foto de perfil</label>
					<input id="photoURL" type="url" class="form-control" formControlName="photoURL" placeholder="https://..."
						[readonly]="!editMode" />
					<small class="text-muted">Pega una URL de imagen pública (por ejemplo desde <a href="https://imgur.com/upload"
							target="_blank">Imgur</a>)</small>
				</div>
			</div>


			<!-- Nombre -->
			<div class="col-md-6">
				<label for="name" class="form-label">Nombre</label>
				<input type="text" id="name" class="form-control" formControlName="name" [readonly]="!editMode">
			</div>

			<!-- Apellido -->
			<div class="col-md-6">
				<label for="last_name" class="form-label">Apellido</label>
				<input type="text" id="last_name" class="form-control" formControlName="last_name" [readonly]="!editMode">
			</div>

			<!-- Username -->
			<div class="col-md-6">
				<label for="user_name" class="form-label">Nombre de usuario</label>
				<input type="text" id="user_name" class="form-control" formControlName="user_name" [readonly]="!editMode">
			</div>

			<!-- Email (siempre deshabilitado) -->
			<div class="col-md-6">
				<label for="email" class="form-label">Correo electrónico</label>
				<input type="email" id="email" class="form-control" formControlName="email" [readonly]="!editMode">
			</div>

			<!-- Teléfonos -->
			<div class="col-md-6">
				<label for="phone" class="form-label">Teléfono</label>
				<input type="text" id="phone" class="form-control" formControlName="phone" [readonly]="!editMode">
			</div>

			<div class="col-md-6">
				<label for="mobile" class="form-label">Celular</label>
				<input type="text" id="mobile" class="form-control" formControlName="mobile" [readonly]="!editMode">
			</div>

			<!-- Dirección -->
			<div class="col-md-6">
				<label for="address" class="form-label">Dirección</label>
				<input type="text" id="address" class="form-control" formControlName="address" [readonly]="!editMode">
			</div>

			<div class="col-md-3">
				<label for="city" class="form-label">Ciudad</label>
				<input type="text" id="city" class="form-control" formControlName="city" [readonly]="!editMode">
			</div>

			<div class="col-md-3">
				<label for="commune" class="form-label">Comuna</label>
				<input type="text" id="commune" class="form-control" formControlName="commune" [readonly]="!editMode">
			</div>

			<!-- Profesión -->
			<div class="col-md-6">
				<label for="profession" class="form-label">Profesión</label>
				<input type="text" id="profession" class="form-control" formControlName="profession" [readonly]="!editMode">
			</div>

			<!-- Enlaces -->
			<div class="col-md-6">
				<label for="website" class="form-label">Sitio Web</label>
				<input type="text" id="website" class="form-control" formControlName="website" [readonly]="!editMode">
			</div>

			<div class="col-md-3">
				<label for="github" class="form-label">GitHub</label>
				<input type="text" id="github" class="form-control" formControlName="github" [readonly]="!editMode">
			</div>

			<div class="col-md-3">
				<label for="instagram" class="form-label">Instagram</label>
				<input type="text" id="instagram" class="form-control" formControlName="instagram" [readonly]="!editMode">
			</div>

			<div class="col-md-3">
				<label for="twitter" class="form-label">Twitter</label>
				<input type="text" id="twitter" class="form-control" formControlName="twitter" [readonly]="!editMode">
			</div>

			<div class="col-md-3">
				<label for="facebook" class="form-label">Facebook</label>
				<input type="text" id="facebook" class="form-control" formControlName="facebook" [readonly]="!editMode">
			</div>

			<!-- Biografía -->
			<div class="col-12">
				<label for="bio" class="form-label">Biografía</label>
				<!-- <textarea rows="4" id="bio" class="form-control" formControlName="bio" [readonly]="!editMode" [class.form-control-plaintext]="!editMode"></textarea> -->
				<textarea rows="4" id="bio" class="form-control" formControlName="bio" [readonly]="!editMode"></textarea>
			</div>

		</div>

		<!-- Botones -->
		<div class="d-flex justify-content-end gap-2 mt-4">
			<button type="button" class="btn btn-secondary btn-lg" (click)="toggleEdit()">
				{{ editMode ? 'Cancelar edición' : 'Editar perfil' }}
			</button>
			<button *ngIf="editMode" type="submit" class="btn btn-success btn-lg"
				[disabled]="!profileForm.valid || !profileForm.dirty">
				Guardar cambios
			</button>
		</div>
	</div>
</form>
 
