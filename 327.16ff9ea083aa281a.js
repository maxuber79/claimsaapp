"use strict";(self.webpackChunkclaims_app=self.webpackChunkclaims_app||[]).push([[327],{2327:(N,d,c)=>{c.r(d),c.d(d,{NotificationsComponent:()=>h});var s=c(467),l=c(2881),f=c(5207),i=c(1360),u=c(5072),m=c(4796),_=c(7473),g=c(9332);const p=(a,r,t,n)=>({"badge-full-danger":a,"badge-full-success":r,"badge-full-warning":t,"badge-full-primary":n});function v(a,r){if(1&a){const t=i.RV6();i.j41(0,"div",14)(1,"div",15)(2,"div")(3,"strong"),i.EFF(4),i.k0s(),i.nrm(5,"br"),i.j41(6,"small",16),i.EFF(7),i.k0s(),i.EFF(8," | "),i.j41(9,"small",17),i.EFF(10),i.k0s()(),i.j41(11,"div",18)(12,"button",19),i.bIt("click",function(){const o=i.eBV(t).$implicit,e=i.XpG(2);return i.Njj(e.markAsRead(o))}),i.nrm(13,"i",20),i.EFF(14),i.k0s(),i.j41(15,"button",21),i.bIt("click",function(){const o=i.eBV(t).$implicit,e=i.XpG(2);return i.Njj(e.deleteNotification(o))}),i.nrm(16,"i",22),i.EFF(17," Eliminar "),i.k0s()()()()}if(2&a){const t=r.$implicit;i.R7$(4),i.JRh(t.message),i.R7$(3),i.SpI("Le\xedda: ",t.read?"S\xed":"No",""),i.R7$(2),i.Y8G("ngClass",i.ziG(8,p,"urgente"===t.type,"asignado"===t.type,"editado"===t.type,"cerrado"===t.type)),i.R7$(),i.SpI(" ",t.type," "),i.R7$(2),i.Y8G("ngClass",t.read?"btn-warning":"btn-full --success")("disabled",t.read),i.R7$(),i.Y8G("ngClass",t.read?"bi-check2-circle":"bi-check-lg"),i.R7$(),i.SpI(" ",t.read?"Notificaci\xf3n le\xedda":"Marcar como le\xedda"," ")}}function E(a,r){if(1&a&&(i.j41(0,"div"),i.DNE(1,v,18,13,"div",13),i.k0s()),2&a){const t=i.XpG();i.R7$(),i.Y8G("ngForOf",t.notifications)}}function b(a,r){1&a&&(i.j41(0,"div",23),i.EFF(1,"No hay notificaciones"),i.k0s())}let h=(()=>{class a{route;auth;notificationService;alertService;notifications=[];loading=!0;constructor(t,n,o,e){this.route=t,this.auth=n,this.notificationService=o,this.alertService=e,console.log("\u{1f514} Componente de notificaciones inicializado")}ngOnInit(){var t=this;return(0,s.A)(function*(){const n=t.route.snapshot.paramMap.get("uid");if(console.log("\u{1f50d} UID encontrado en componente de notificaciones:",n),n){t.notificationService.getUserNotifications(n).subscribe({next:o=>{t.notifications=o,console.log("\u{1f4e8} Notificaciones cargadas:",t.notifications)},error:o=>{console.error("\u274c Error cargando notificaciones:",o)}});try{console.log("\u{1f4e8} Notificaciones cargadas:",t.notifications)}catch(o){console.error("\u274c Error cargando notificaciones:",o)}finally{t.loading=!1}}else console.warn("\u274c No se encontr\xf3 UID en la ruta")})()}markAsRead(t){var n=this;return(0,s.A)(function*(){const o=n.route.snapshot.paramMap.get("uid");if(o&&t.id)try{yield n.notificationService.markAsRead(o,t.id),t.read=!0,n.notifications=n.notifications.filter(e=>!e.read),console.log(`\u{1f4d7} Notificaci\xf3n marcada como le\xedda: ${t.message}`),n.alertService.showToastSuccess("Notificaci\xf3n marcada como le\xedda","Mensaje importante!")}catch(e){console.error("\u274c Error al marcar como le\xedda:",e)}})()}deleteNotification(t){var n=this;return(0,s.A)(function*(){const o=n.route.snapshot.paramMap.get("uid");if(o&&t.id)try{yield n.notificationService.deleteNotification(o,t.id),n.notifications=n.notifications.filter(e=>e.id!==t.id),console.log(`\u{1f5d1}\ufe0f Notificaci\xf3n eliminada: ${t.message}`),n.alertService.showToastError("Notificaci\xf3n eliminada","Mensaje importante!")}catch(e){console.error("\u274c Error al eliminar notificaci\xf3n:",e)}})()}markAllAsRead(){var t=this;return(0,s.A)(function*(){const n=t.route.snapshot.paramMap.get("uid");if(n)try{for(const o of t.notifications)!o.read&&o.id&&(yield t.notificationService.markAsRead(n,o.id),o.read=!0);t.notifications=t.notifications.filter(o=>!o.read),t.alertService.showToastSuccess("Notificaci\xf3n marcada como le\xedda","Todas las notificaciones"),console.log("\u{1f4d7} Todas las notificaciones marcadas como le\xeddas")}catch(o){console.error("\u274c Error al marcar todas como le\xeddas:",o)}})()}static \u0275fac=function(n){return new(n||a)(i.rXU(u.nX),i.rXU(m.u),i.rXU(_.J),i.rXU(g.u))};static \u0275cmp=i.VBU({type:a,selectors:[["app-notifications"]],decls:19,vars:4,consts:[["noNotificaciones",""],[1,"row"],[1,"col-12","grid-margin"],[1,"card"],[1,"card-body"],[1,"col-12","py-3","d-flex","justify-content-end"],[1,"btn","btn-full","--success",3,"click"],[1,"bi","bi-check-all"],[1,"col-12","mb-3"],[1,"bi","bi-bell-fill","text-warning"],[1,"badge","badge-type","badge-outline-info"],[1,"col-12"],[4,"ngIf","ngIfElse"],["class","list-group-item border my-2 p-3 rounded bg-light",4,"ngFor","ngForOf"],[1,"list-group-item","border","my-2","p-3","rounded","bg-light"],[1,"d-flex","justify-content-between","align-items-center"],[1,"text-muted"],[1,"badge",3,"ngClass"],[1,"btn-group"],[1,"btn","m-1","btn-sm",3,"click","ngClass","disabled"],[1,"bi",3,"ngClass"],[1,"btn","btn-full","--danger","m-1","btn-sm",3,"click"],[1,"bi","bi-trash3-fill"],[1,"alert","alert-info","mt-3"]],template:function(n,o){if(1&n){const e=i.RV6();i.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",1)(5,"div",5)(6,"button",6),i.bIt("click",function(){return i.eBV(e),i.Njj(o.markAllAsRead())}),i.nrm(7,"i",7),i.EFF(8," Marcar todas como le\xeddas "),i.k0s()(),i.j41(9,"div",8)(10,"h2"),i.nrm(11,"i",9),i.EFF(12," Notificaciones "),i.j41(13,"small",10),i.EFF(14),i.k0s()()(),i.j41(15,"div",11),i.DNE(16,E,2,1,"div",12)(17,b,2,0,"ng-template",null,0,i.C5r),i.k0s()()()()()()}if(2&n){const e=i.sdS(18);i.R7$(14),i.Lme("",o.notifications.length," notificaci\xf3n",1===o.notifications.length?"":"es",""),i.R7$(2),i.Y8G("ngIf",o.notifications.length>0)("ngIfElse",e)}},dependencies:[l.MD,l.YU,l.Sq,l.bT,f.iI],encapsulation:2})}return a})()}}]);