import{i as D}from"./chunk-VYWRVR3S.js";import{a as E}from"./chunk-34SF47SS.js";import"./chunk-2BL6JQEY.js";import"./chunk-N6RA7QK6.js";import{a as U,c as F,d as I,e as R,h as y,j as C,k as N,l as x,m as k,n as w,p as A,r as _}from"./chunk-5RABQZIW.js";import"./chunk-3OADCOYV.js";import{Da as f,Ja as i,La as b,Ta as d,ba as a,fa as m,ha as v,sa as n,sb as h,ta as t,ua as e,ub as S,va as u,vb as g}from"./chunk-5TBBY7BX.js";var M=()=>["/dashboard","analytics"],G=()=>["/dashboard","admin-users"],j=class c{constructor(o,l,r,s,p){this.fb=o;this.route=l;this.userService=r;this.router=s;this.alertService=p}roleForm;userId;userData;ngOnInit(){if(this.userId=this.route.snapshot.paramMap.get("uid")||"",console.log("\u{1F4CD} UID capturado desde ruta:",this.userId),!this.userId){console.warn("\u26A0\uFE0F No se pudo obtener el UID desde la URL");return}this.roleForm=this.fb.group({rol:["",F.required],status:[!1]}),this.userService.getUserProfile(this.userId).subscribe(o=>{o?(this.userData=o,this.roleForm.patchValue({rol:o.rol||"Ejecutivo",status:o.activo||!1}),console.log("\u2705 Usuario cargado para editar rol/estatus:",this.userData)):console.warn("\u26A0\uFE0F Usuario no encontrado con UID:",this.userId)})}get rol(){return this.roleForm.get("rol")}onSubmit(){if(this.roleForm.invalid||!this.userData?.uid){console.warn("\u26A0\uFE0F Formulario inv\xE1lido o UID no disponible.");return}let{rol:o,status:l}=this.roleForm.value;console.log("\u{1F4CD} Datos a guardar:",{rol:o,status:l});let r=this.userService.updateUserRole(this.userData.uid,o),s=this.userService.toggleUserStatus(this.userData.uid,l);Promise.all([r,s]).then(()=>{console.log("\u2705 Rol y estatus actualizados correctamente"),this.alertService.showToastSuccess("Usuario actualizado con \xE9xito \u2705","Mensaje"),this.router.navigate(["/dashboard/admin-users"])}).catch(p=>{console.error("\u274C Error al actualizar rol/estatus:",p),this.alertService.error("Error al actualizar usuario")})}static \u0275fac=function(l){return new(l||c)(m(A),m(h),m(E),m(S),m(D))};static \u0275cmp=v({type:c,selectors:[["app-user-role-edit"]],decls:57,vars:10,consts:[[1,"row"],[1,"col-12","grid-margin"],[1,"card"],[1,"card-body"],["aria-label","breadcrumb",1,""],[1,"breadcrumb","mb-0"],[1,"breadcrumb-item"],[3,"routerLink"],[1,"card","p-4"],[1,"mb-1"],[3,"ngSubmit","formGroup"],[1,"col-12"],[1,"form-group"],[1,"form-label"],["disabled","",1,"form-control",3,"value"],[1,"col-sm-12","col-md-6"],["formControlName","rol",1,"form-select"],["value","Administrador"],["value","Ejecutivo"],[1,"form-check","form-switch"],["type","checkbox","role","switch","id","switchCheckDefault","formControlName","status",1,"form-check-input"],["for","switchCheckDefault",1,"form-check-label"],[1,"wrapp-btn","text-end"],["type","submit",1,"btn","btn-full","--primary","m-1",3,"disabled"]],template:function(l,r){if(l&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"nav",4)(5,"ol",5)(6,"li",6)(7,"a",7),i(8,"Home"),e()(),t(9,"li",6)(10,"a",7),i(11,"Management users"),e()(),t(12,"li",6),i(13,"Editar Role"),e()()()()()()(),t(14,"div",0)(15,"div",1)(16,"div",8)(17,"h4",9),i(18,"Editar Rol del Usuario "),e(),t(19,"form",10),f("ngSubmit",function(){return r.onSubmit()}),t(20,"div",0)(21,"div",11)(22,"div",12)(23,"label",13),i(24,"UID"),e(),u(25,"input",14),e()(),t(26,"div",15)(27,"div",12)(28,"label",13),i(29,"Email"),e(),u(30,"input",14),e()(),t(31,"div",15)(32,"div",12)(33,"label",13),i(34,"Nombre"),e(),u(35,"input",14),e()(),t(36,"div",15)(37,"div",12)(38,"label",13),i(39,"Selecciona el Rol"),e(),t(40,"select",16)(41,"option",17),i(42,"Administrador"),e(),t(43,"option",18),i(44,"Ejecutivo"),e()()()(),t(45,"div",15)(46,"div",12)(47,"label",13),i(48,"Selecciona el Rol"),e()(),t(49,"div",19),u(50,"input",20),t(51,"label",21),i(52),e()()(),t(53,"div",11)(54,"div",22)(55,"button",23),i(56," Guardar Cambios "),e()()()()()()()()),l&2){let s;a(7),n("routerLink",d(8,M)),a(3),n("routerLink",d(9,G)),a(9),n("formGroup",r.roleForm),a(6),n("value",r.userData.uid),a(5),n("value",r.userData.email),a(5),n("value",r.userData.name+" "+r.userData.last_name),a(17),b(" Estatus ",(s=r.roleForm.get("status"))!=null&&s.value?"activo":"inactivo"," usuario "),a(3),n("disabled",r.roleForm.invalid)}},dependencies:[_,y,k,w,U,x,I,R,C,N,g],encapsulation:2})};export{j as UserRoleEditComponent};
