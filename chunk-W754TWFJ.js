import{a as J}from"./chunk-4H67W4SF.js";import{i as R}from"./chunk-VYWRVR3S.js";import{a as L}from"./chunk-34SF47SS.js";import"./chunk-2BL6JQEY.js";import{a as A}from"./chunk-N6RA7QK6.js";import{b as P,d as V,e as j,h as G,j as T,k as z,p as B,q as O,r as H}from"./chunk-5RABQZIW.js";import"./chunk-3OADCOYV.js";import{Ba as N,Da as f,Fa as C,Ja as r,Ka as m,L as p,La as h,M as c,Ma as U,Ta as S,a as y,aa as E,ba as o,fa as u,ha as D,ib as w,kb as M,la as x,mb as _,sa as n,sb as F,ta as e,ua as t,va as a,vb as I,xb as k}from"./chunk-5TBBY7BX.js";var q=()=>["/dashboard"],K=()=>["/dashboard/admin-users"];function Q(b,d){b&1&&(e(0,"button",87),r(1,"Guardar cambios"),t())}var W=class b{constructor(d,l,i,s,v,g){this.route=d;this.fb=l;this.userService=i;this.authService=s;this.alertService=v;this.storage=g;console.log("%c<<< Start constructor >>>","background: #fff3cd; color: #664d03; padding: 2px 5px;")}uid="";profileEditUserForm;userData=null;editMode=!1;isDisabled=!1;loadUserData;loading=!0;isSaving=!1;isLoading=!0;defaultImage="https://randomuser.me/api/portraits/men/40.jpg";previewUrl=null;imageFile=null;fileName="";perfil=null;config=null;ngOnInit(){console.log("%c<<< Start ngOnInit >>>","background: #fff3cd; color: #664d03; padding: 2px 5px;"),this.profileEditUserForm=this.fb.group({uid:[{value:"",disabled:!0}],email:[{value:"",disabled:!0}],photoURL:[""],name:[""],last_name:[""],user_name:[""],username:[""],phone:[""],mobile:[""],address:[""],city:[""],commune:[""],profession:[""],website:[""],github:[""],instagram:[""],twitter:[""],facebook:[""],bio:[""]});let d=this.route.snapshot.paramMap.get("uid");if(console.log("%c<<< UID recibido desde ruta >>>","background: #d1e7dd; color: #0f5132; padding: 2px 5px;",d),!d){console.error("\u274C No se recibi\xF3 UID en la ruta, no se puede cargar el usuario");return}this.uid=d,this.isLoading=!0,this.userService.getUserProfile(this.uid).subscribe({next:l=>{if(!l){console.warn("\u26A0\uFE0F No se encontr\xF3 informaci\xF3n para UID:",this.uid),this.isLoading=!1;return}this.userData=l,this.perfil=y({},l),this.isLoading=!1,console.log("%c\u2705 Usuario cargado correctamente >>>","background: #198754; color: #fff; padding: 2px 5px;",this.userData),this.profileEditUserForm.patchValue({uid:this.userData.uid||"",email:this.userData.email||"",photoURL:this.userData.photoURL||"",name:this.userData.name||"",last_name:this.userData.last_name||"",user_name:this.userData.user_name||"",username:this.userData.username||"n/a",phone:this.userData.phone||"",mobile:this.userData.mobile||"",address:this.userData.address||"",city:this.userData.city||"",commune:this.userData.commune||"",profession:this.userData.profession||"",website:this.userData.website||"",github:this.userData.github||"",instagram:this.userData.instagram||"",twitter:this.userData.twitter||"",facebook:this.userData.facebook||"",bio:this.userData.bio||""}),console.log("%c<<< Formulario patchValue >>>","background: #d1e7dd; color: #0f5132; padding: 2px 5px;",this.profileEditUserForm.value)},error:l=>{console.error("\u274C Error al cargar usuario desde Firestore:",l),this.isLoading=!1}})}toggleEdit(){this.editMode=!this.editMode,this.isDisabled=!this.isDisabled,console.log("%c<<< Modo edici\xF3n >>>","background: #d1e7dd; color: #0f5132; padding: 2px 5px;",this.editMode)}saveProfile(){if(console.log("%c<<< Guardar perfil >>>","background: #0d6efd; color: #fff; padding: 2px 5px;",this.profileEditUserForm.value),this.profileEditUserForm.invalid){this.alertService.error("\u26A0\uFE0F El formulario es inv\xE1lido. Revisa los campos."),this.profileEditUserForm.markAllAsTouched();return}let d=this.profileEditUserForm.getRawValue();if(console.log("%c<<< Datos a actualizar >>>","background: #d1e7dd; color: #0f5132; padding: 2px 5px;",d),!this.uid){this.alertService.error("\u274C No se encontr\xF3 UID para actualizar.");return}this.isSaving=!0,console.log("\u{1F504} Guardando cambios en Firestore para UID:",this.uid),this.userService.updateUserProfile(this.uid,d).subscribe({next:()=>{console.log("%c\u2705 Perfil actualizado correctamente","background: #198754; color: #fff; padding: 2px 5px;"),this.alertService.success("Perfil actualizado correctamente \u2705"),this.perfil=y(y({},this.perfil),d),this.isSaving=!1,this.editMode=!1},error:l=>{console.error("%c\u274C Error al actualizar perfil:","background: #f8d7da; color: #842029; padding: 2px 5px;",l),this.alertService.error("\u274C Error al guardar perfil, revisa la consola"),this.isSaving=!1}})}onFileSelected(d){let l=d.target;if(l.files&&l.files.length>0){this.imageFile=l.files[0],this.fileName=this.imageFile.name;let i=new FileReader;i.onload=s=>{this.previewUrl=s.target?.result},i.readAsDataURL(this.imageFile)}}static \u0275fac=function(l){return new(l||b)(u(F),u(B),u(L),u(A),u(R),u(J))};static \u0275cmp=D({type:b,selectors:[["app-profile-edit"]],decls:176,vars:38,consts:[["fileInput",""],[1,"row"],[1,"col-12","text-start","grid-margin"],[1,"card"],[1,"card-body"],[1,"col-12"],["aria-label","breadcrumb",1,""],[1,"breadcrumb","mb-0"],[1,"breadcrumb-item"],[3,"routerLink"],["aria-current","page",1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-lg-4","grid-margin"],[1,"card","mb-4"],[1,"card-body","text-center"],[1,"position-relative","d-inline-block"],["alt","Profile Picture","width","120","height","120",1,"rounded-circle","object-fit-cover","profile-pic",3,"src"],["type","file","accept","image/*","hidden","",3,"change"],[1,"btn","btn-primary","btn-sm","position-absolute","bottom-0","end-0","rounded-circle",3,"click"],[1,"fas","fa-camera"],[1,"my-2"],[1,"text-muted","mb-1"],[1,"badge","bg-primary-subtle","text-primary","px-3","py-2","rounded-pill"],[1,"text-muted","mb-2"],[1,"mb-4"],[1,"badge","bg-success-subtle","text-dark","px-3","py-2","rounded-pill"],[1,"d-flex","justify-content-center","mb-2"],["type","button","data-mdb-button-init","","data-mdb-ripple-init","",1,"btn","btn-primary"],["type","button","data-mdb-button-init","","data-mdb-ripple-init","",1,"btn","btn-outline-primary","ms-1"],[1,"list-group","list-group-flush","rounded-3"],[1,"list-group-item","d-flex","justify-content-between","align-items-center","p-3"],[1,"fas","fa-globe","fa-lg","text-warning"],[1,"mb-0"],[1,"fab","fa-github","fa-lg","text-body"],[1,"fab","fa-twitter","fa-lg",2,"color","#55acee"],[1,"fab","fa-instagram","fa-lg",2,"color","#ac2bac"],[1,"fab","fa-facebook-f","fa-lg",2,"color","#3b5998"],[1,"col-lg-8","grid-margin"],[3,"ngSubmit","formGroup"],[1,"row","form-group"],["for","uid",1,"col-sm-3","col-form-label"],[1,"col-sm-9"],["type","text","id","uid","formControlName","uid",1,"form-control",3,"readonly"],["for","email",1,"col-sm-3","col-form-label"],["type","text","id","staticEmail","formControlName","email",1,"form-control-plaintext",3,"readonly"],["for","photoURL",1,"col-sm-3","col-form-label"],["id","photoURL","type","url","formControlName","photoURL","placeholder","https://...",1,"form-control",3,"readonly"],[1,"form-text","text-end"],["href","https://imgur.com/upload","target","_blank"],["for","name",1,"col-sm-3","col-form-label"],["type","text","id","name","formControlName","name",1,"form-control",3,"readonly"],["for","last_name",1,"col-sm-3","col-form-label"],["type","text","id","last_name","formControlName","last_name",1,"form-control",3,"readonly"],["for","user_name",1,"col-sm-3","col-form-label"],["type","text","id","user_name","formControlName","user_name",1,"form-control",3,"readonly"],["type","text","id","username","formControlName","username",1,"form-control",3,"readonly"],["for","phone",1,"col-sm-3","col-form-label"],["type","text","id","phone","formControlName","phone",1,"form-control",3,"readonly"],["for","mobile",1,"col-sm-3","col-form-label"],["type","text","id","mobile","formControlName","mobile",1,"form-control",3,"readonly"],["for","address",1,"col-sm-3","col-form-label"],["type","text","id","address","formControlName","address",1,"form-control",3,"readonly"],[1,"row","g-0"],[1,"col-sm-12","col-md-6"],["for","city",1,"col-sm-6","col-form-label"],[1,"col-sm-6"],["type","text","id","city","formControlName","city",1,"form-control",3,"readonly"],["for","commune",1,"col-sm-3","col-form-label"],["type","text","id","commune","formControlName","commune",1,"form-control",3,"readonly"],["for","profession",1,"col-sm-3","col-form-label"],["type","text","id","profession","formControlName","profession",1,"form-control",3,"readonly"],["for","website",1,"col-sm-3","col-form-label"],["type","text","id","website","formControlName","website",1,"form-control",3,"readonly"],["for","github",1,"col-sm-3","col-form-label"],["type","text","id","github","formControlName","github",1,"form-control",3,"readonly"],["for","instagram",1,"col-sm-3","col-form-label"],["type","text","id","instagram","formControlName","instagram",1,"form-control",3,"readonly"],["for","twitter",1,"col-sm-3","col-form-label"],["type","text","id","twitter","formControlName","twitter",1,"form-control",3,"readonly"],["for","facebook",1,"col-sm-3","col-form-label"],["type","text","id","facebook","formControlName","facebook",1,"form-control",3,"readonly"],["for","bio",1,"col-sm-3","col-form-label"],["rows","4","id","bio","formControlName","bio",1,"form-control",3,"readonly"],[1,"card-footer","py-3"],[1,"wrapp-btn","btn-right"],["type","button",1,"btn","btn-full","m-1",3,"click","ngClass"],["type","submit","class","btn btn-full --success m-1",4,"ngIf"],["type","submit",1,"btn","btn-full","--success","m-1"]],template:function(l,i){if(l&1){let s=N();e(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",1)(5,"div",5)(6,"nav",6)(7,"ol",7)(8,"li",8)(9,"a",9),r(10,"Home"),t()(),e(11,"li",10)(12,"a",9),r(13,"Admin Users"),t()(),e(14,"li",11),r(15,"Editor de perfil"),t()()()()()()()()(),e(16,"div",1)(17,"div",12)(18,"div",13)(19,"div",14)(20,"div",15),a(21,"img",16),e(22,"input",17,0),f("change",function(g){return p(s),c(i.onFileSelected(g))}),t(),e(24,"button",18),f("click",function(){p(s);let g=C(23);return c(g.click())}),a(25,"i",19),t()(),e(26,"h5",20),r(27),t(),e(28,"p",21)(29,"span",22),r(30),t()(),e(31,"p",23),r(32),t(),e(33,"p",24)(34,"span",25),r(35),t()(),e(36,"div",26)(37,"button",27),r(38,"Follow"),t(),e(39,"button",28),r(40,"Message"),t()()()(),e(41,"div",13)(42,"div",4)(43,"ul",29)(44,"li",30),a(45,"i",31),e(46,"p",32),r(47),t()(),e(48,"li",30),a(49,"i",33),e(50,"p",32),r(51),t()(),e(52,"li",30),a(53,"i",34),e(54,"p",32),r(55),t()(),e(56,"li",30),a(57,"i",35),e(58,"p",32),r(59),t()(),e(60,"li",30),a(61,"i",36),e(62,"p",32),r(63),t()()()()()(),e(64,"div",37)(65,"div",13)(66,"form",38),f("ngSubmit",function(){return p(s),c(i.saveProfile())}),e(67,"div",4)(68,"div",39)(69,"label",40),r(70,"UID"),t(),e(71,"div",41),a(72,"input",42),t()(),e(73,"div",39)(74,"label",43),r(75,"Email"),t(),e(76,"div",41),a(77,"input",44),t()(),e(78,"div",39)(79,"label",45),r(80,"URL foto perfil..."),t(),e(81,"div",41),a(82,"input",46),e(83,"div",47),r(84,"Pega una URL de imagen p\xFAblica (por ejemplo desde "),e(85,"a",48),r(86,"Imgur"),t(),r(87,")"),t()()(),e(88,"div",39)(89,"label",49),r(90,"Nombres"),t(),e(91,"div",41),a(92,"input",50),t()(),e(93,"div",39)(94,"label",51),r(95,"Apellidos"),t(),e(96,"div",41),a(97,"input",52),t()(),e(98,"div",39)(99,"label",53),r(100,"Username"),t(),e(101,"div",41),a(102,"input",54),t()(),e(103,"div",39)(104,"label",53),r(105,"Username"),t(),e(106,"div",41),a(107,"input",55),t()(),e(108,"div",39)(109,"label",56),r(110,"Tel\xE9fono"),t(),e(111,"div",41),a(112,"input",57),t()(),e(113,"div",39)(114,"label",58),r(115,"Celular"),t(),e(116,"div",41),a(117,"input",59),t()(),e(118,"div",39)(119,"label",60),r(120,"Direcci\xF3n"),t(),e(121,"div",41),a(122,"input",61),t()(),e(123,"div",62)(124,"div",63)(125,"div",39)(126,"label",64),r(127,"Ciudad"),t(),e(128,"div",65),a(129,"input",66),t()()(),e(130,"div",63)(131,"div",39)(132,"label",67),r(133,"Comuna"),t(),e(134,"div",41),a(135,"input",68),t()()()(),e(136,"div",39)(137,"label",69),r(138,"Profesi\xF3n"),t(),e(139,"div",41),a(140,"input",70),t()(),e(141,"div",39)(142,"label",71),r(143,"Sitio Web"),t(),e(144,"div",41),a(145,"input",72),t()(),e(146,"div",39)(147,"label",73),r(148,"GitHub"),t(),e(149,"div",41),a(150,"input",74),t()(),e(151,"div",39)(152,"label",75),r(153,"Instagram"),t(),e(154,"div",41),a(155,"input",76),t()(),e(156,"div",39)(157,"label",77),r(158,"Twitter"),t(),e(159,"div",41),a(160,"input",78),t()(),e(161,"div",39)(162,"label",79),r(163,"Facebook"),t(),e(164,"div",41),a(165,"input",80),t()(),e(166,"div",39)(167,"label",81),r(168,"Biograf\xEDa"),t(),e(169,"div",41),a(170,"textarea",82),t()()(),e(171,"div",83)(172,"div",84)(173,"button",85),f("click",function(){return p(s),c(i.toggleEdit())}),r(174),t(),x(175,Q,2,0,"button",86),t()()()()()()}l&2&&(o(9),n("routerLink",S(36,q)),o(3),n("routerLink",S(37,K)),o(9),n("src",(i.userData==null?null:i.userData.photoURL)||i.defaultImage,E),o(6),m((i.userData==null?null:i.userData.name)+" "+(i.userData==null?null:i.userData.last_name)||"N/A"),o(3),m((i.userData==null?null:i.userData.profession)||"N/A"),o(2),U("",(i.userData==null?null:i.userData.address)||"N/A",", ",(i.userData==null?null:i.userData.city)||"N/A"),o(3),h(" ",(i.userData==null?null:i.userData.uid)||"N/A"," "),o(12),m((i.userData==null?null:i.userData.website)||"N/A"),o(4),m((i.userData==null?null:i.userData.github)||"N/A"),o(4),m((i.userData==null?null:i.userData.twitter)||"N/A"),o(4),m((i.userData==null?null:i.userData.instagram)||"N/A"),o(4),m((i.userData==null?null:i.userData.facebook)||"N/A"),o(3),n("formGroup",i.profileEditUserForm),o(6),n("readonly",!i.editMode),o(5),n("readonly",!i.editMode),o(5),n("readonly",!i.editMode),o(10),n("readonly",!i.editMode),o(5),n("readonly",!i.editMode),o(5),n("readonly",!i.editMode),o(5),n("readonly",!i.editMode),o(5),n("readonly",!i.editMode),o(5),n("readonly",!i.editMode),o(5),n("readonly",!i.editMode),o(7),n("readonly",!i.editMode),o(6),n("readonly",!i.editMode),o(5),n("readonly",!i.editMode),o(5),n("readonly",!i.editMode),o(5),n("readonly",!i.editMode),o(5),n("readonly",!i.editMode),o(5),n("readonly",!i.editMode),o(5),n("readonly",!i.editMode),o(5),n("readonly",!i.editMode),o(3),n("ngClass",i.editMode?"--danger":"--primary"),o(),h(" ",i.editMode?"Cancelar edici\xF3n":"Editar perfil"," "),o(),n("ngIf",i.editMode))},dependencies:[_,w,M,O,G,P,V,j,H,T,z,k,I],encapsulation:2})};export{W as ProfileEditComponent};
