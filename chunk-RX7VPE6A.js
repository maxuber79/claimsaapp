import{a as et}from"./chunk-34SF47SS.js";import{a as Q,b as W,d as O,h as E,j as C,m as c,n as w,o as a,p as X,s as Z,t as j,u as P,v as tt}from"./chunk-2BL6JQEY.js";import{a as M}from"./chunk-N6RA7QK6.js";import{E as J}from"./chunk-3OADCOYV.js";import{A as g,D as u,Ea as F,G as s,H as L,Ia as b,Ja as T,Ka as D,Qa as $,Ra as z,a as d,b as l,ba as n,fa as N,g as f,ha as q,ib as G,kb as K,la as _,mb as V,pb as Y,r as y,s as B,sa as I,t as m,ta as h,u as p,ua as x,va as A,x as H,z as k}from"./chunk-5TBBY7BX.js";var rt=class o{constructor(e,t,r){this.firestore=e;this.auth=t;this.authService=r;console.log("%c<<< Start TODO service >>>","background: #fff3cd; color: #664d03; padding: 2px 5px;")}addTodo(e){return f(this,null,function*(){let t=yield m(this.authService.getCurrentUser());if(!t?.uid)throw new Error("Usuario no autenticado");let r=c(this.firestore,`users/${t.uid}/todos`),i=a(r),v=new Date,S=l(d({},e),{id:i.id,completed:!1,createdAt:v,updatedAt:v});console.log("\u{1F9FE} Creando tarea en:",`users/${t.uid}/todos/${i.id}`),console.log("\u{1F4DD} Datos:",S),yield j(i,S)})}getTodos(){return this.authService.getCurrentUser().pipe(g(e=>{let t=c(this.firestore,`users/${e.uid}/todos`);return C(t,{idField:"id"})}))}updateTodo(e,t){return f(this,null,function*(){let r=yield m(this.authService.getCurrentUser());if(!r?.uid)throw new Error("Usuario no autenticado");let i=a(this.firestore,`users/${r.uid}/todos/${e}`);yield P(i,l(d({},t),{updatedAt:Q.now()}))})}deleteTodo(e){return f(this,null,function*(){let t=yield m(this.authService.getCurrentUser());if(!t?.uid)throw new Error("Usuario no autenticado");let r=a(this.firestore,`users/${t.uid}/todos/${e}`);yield w(r)})}clearAllTodos(){return f(this,null,function*(){let e=yield m(this.getTodos()),t=yield m(this.authService.getCurrentUser());if(!t?.uid)throw new Error("Usuario no autenticado");let r=e.map(i=>w(a(this.firestore,`users/${t.uid}/todos/${i.id}`)));yield Promise.all(r)})}getPendingTodosCount(){return this.authService.getCurrentUser().pipe(g(e=>{let t=c(this.firestore,`users/${e.uid}/todos`),r=Z(t,tt("completed","==",!1));return C(r).pipe(p(i=>i.length))}))}getTodoById(e){return f(this,null,function*(){let t=yield m(this.authService.getCurrentUser());if(!t?.uid)throw new Error("Usuario no autenticado");let r=a(this.firestore,`users/${t.uid}/todos/${e}`),i=yield X(r);if(!i.exists())throw new Error("Tarea no encontrada");return i.data()})}static \u0275fac=function(t){return new(t||o)(s(E),s(J),s(M))};static \u0275prov=u({token:o,factory:o.\u0275fac,providedIn:"root"})};var U=class o{constructor(e,t){this.authService=e;this.userService=t;console.log("%c<<< Start CLAIMS service >>>","background: #fff3cd; color: #664d03; padding: 2px 5px;")}firestore=L(E);createClaim(e,t){let r=t.id||a(W(this.firestore,`users/${e}/claims`)).id,i=a(this.firestore,`users/${e}/claims/${r}`);return j(i,l(d({},t),{id:r}))}updateClaim(e,t){let r=a(this.firestore,`users/${e}/claims/${t.id}`);return P(r,d({},t))}deleteClaim(e,t){let r=a(this.firestore,`users/${e}/claims/${t}`);return w(r)}getUserClaims(e){let t=c(this.firestore,`users/${e}/claims`);return C(t,{idField:"id"})}getAllClaims(){let e=c(this.firestore,"users");return console.log("\u{1F50D} Buscando todos los reclamos de todos los ejecutivos...",e),y(O(e)).pipe(g(t=>{let r=t.docs.map(i=>{let v=i.id,S=c(this.firestore,`users/${v}/claims`);return O(S).then(at=>at.docs.map(st=>l(d({},st.data()),{uidEjecutivo:v})))});return y(Promise.all(r))}),p(t=>t.flat()))}getClaimsByUid(e){let t=c(this.firestore,`users/${e}/claims`);return y(O(t)).pipe(p(r=>r.docs.map(i=>l(d({},i.data()),{uidEjecutivo:e,id:i.id}))))}static \u0275fac=function(t){return new(t||o)(s(M),s(et))};static \u0275prov=u({token:o,factory:o.\u0275fac,providedIn:"root"})};function dt(o,e){if(o&1&&A(0,"i"),o&2){let t=F();b($("bi ",t.trendIconLeft))}}function lt(o,e){if(o&1&&A(0,"i"),o&2){let t=F();b($("bi ",t.trendIcon," text-white"))}}var ot=class o{constructor(e){this.claimsService=e}icon="";count="";label="";color="primary";ngOnInit(){}footerText;trendIcon;trendIconLeft;static \u0275fac=function(t){return new(t||o)(N(U))};static \u0275cmp=q({type:o,selectors:[["app-card-metric"]],inputs:{icon:"icon",count:"count",label:"label",color:"color",footerText:"footerText",trendIcon:"trendIcon",trendIconLeft:"trendIconLeft"},decls:15,vars:13,consts:[[1,"card","h-100","shadow-sm"],[1,"card-body","d-flex","justify-content-between","align-items-center","p-4"],[1,"d-flex","align-items-center","gap-3"],[1,"card-text","text-muted","m-0","f-size-3"],[1,"card-footer","d-flex","justify-content-between","align-items-center","py-2","px-3",3,"ngClass"],[1,"d-flex","align-items-center","gap-2","text-white"],[3,"class",4,"ngIf"]],template:function(t,r){t&1&&(h(0,"div",0)(1,"div",1)(2,"div",2),A(3,"i"),h(4,"div")(5,"h3"),T(6),x(),h(7,"p",3),T(8),x()()()(),h(9,"div",4)(10,"div",5),_(11,dt,1,3,"i",6),h(12,"small"),T(13),x()(),_(14,lt,1,3,"i",6),x()()),t&2&&(n(3),b(z("bi ",r.icon," f-size-20 text-",r.color)),n(2),b($("card-title m-0 fw-bold text-",r.color)),n(),D(r.count),n(2),D(r.label),n(),I("ngClass","bg-"+r.color),n(2),I("ngIf",r.trendIconLeft),n(2),D(r.footerText),n(),I("ngIf",r.trendIcon))},dependencies:[V,G,K],styles:[".card-extended[_ngcontent-%COMP%]{transition:transform .2s ease;border-radius:1rem}.card-extended[_ngcontent-%COMP%]:hover{transform:translateY(-3px)}.card-extended[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]{font-size:.75rem;font-weight:500;min-height:40px;color:#fff!important}"]})};var it=class o{constructor(e){this.http=e;console.log("%c<<< Start MOCK-DATA service >>>","background: #fff3cd; color: #664d03; padding: 2px 5px;")}BASE_PATH="assets/data/";DATA_FILE="dashboard-data.json";getDashboardMetrics(){return this.http.get(`${this.BASE_PATH}dashboard-data.json`)}getTicketGraph(){return this.http.get(`${this.BASE_PATH}${this.DATA_FILE}`).pipe(p(e=>e.chartData.tickets))}getSatisfactionData(){return this.http.get(`${this.BASE_PATH}satisfaction.json`)}getChannelsData(){return this.http.get(`${this.BASE_PATH}channels.json`)}getNotifications(){return this.http.get(`${this.BASE_PATH}notifications.json`)}getReclamos(){return this.http.get(`${this.BASE_PATH}reclamos.json`).pipe(k(2),H(e=>(console.error("\u274C Error al cargar reclamos:",e),B([]))))}generateUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}static \u0275fac=function(t){return new(t||o)(s(Y))};static \u0275prov=u({token:o,factory:o.\u0275fac,providedIn:"root"})};export{rt as a,U as b,ot as c,it as d};
