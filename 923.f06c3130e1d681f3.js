"use strict";(self.webpackChunkclaims_app=self.webpackChunkclaims_app||[]).push([[923],{2923:(p,n,a)=>{a.r(n),a.d(n,{UserRoleEditComponent:()=>b});var r=a(4341),c=a(5207),e=a(1360),d=a(5072),m=a(9885),v=a(9332);const h=()=>["/dashboard","analytics"],E=()=>["/dashboard","admin-users"];let b=(()=>{class l{fb;route;userService;router;alertService;roleForm;userId;userData;constructor(t,s,o,i,u){this.fb=t,this.route=s,this.userService=o,this.router=i,this.alertService=u}ngOnInit(){this.userId=this.route.snapshot.paramMap.get("uid")||"",console.log("\u{1f4cd} UID capturado desde ruta:",this.userId),this.userId?(this.roleForm=this.fb.group({rol:["",r.k0.required],status:[!1]}),this.userService.getUserProfile(this.userId).subscribe(t=>{t?(this.userData=t,this.roleForm.patchValue({rol:t.rol||"Ejecutivo",status:t.activo||!1}),console.log("\u2705 Usuario cargado para editar rol/estatus:",this.userData)):console.warn("\u26a0\ufe0f Usuario no encontrado con UID:",this.userId)})):console.warn("\u26a0\ufe0f No se pudo obtener el UID desde la URL")}get rol(){return this.roleForm.get("rol")}onSubmit(){if(this.roleForm.invalid||!this.userData?.uid)return void console.warn("\u26a0\ufe0f Formulario inv\xe1lido o UID no disponible.");const{rol:t,status:s}=this.roleForm.value;console.log("\u{1f4cd} Datos a guardar:",{rol:t,status:s});const o=this.userService.updateUserRole(this.userData.uid,t),i=this.userService.toggleUserStatus(this.userData.uid,s);Promise.all([o,i]).then(()=>{console.log("\u2705 Rol y estatus actualizados correctamente"),this.alertService.showToastSuccess("Usuario actualizado con \xe9xito \u2705","Mensaje"),this.router.navigate(["/dashboard/admin-users"])}).catch(u=>{console.error("\u274c Error al actualizar rol/estatus:",u),this.alertService.error("Error al actualizar usuario")})}static \u0275fac=function(s){return new(s||l)(e.rXU(r.ok),e.rXU(d.nX),e.rXU(m.D),e.rXU(d.Ix),e.rXU(v.u))};static \u0275cmp=e.VBU({type:l,selectors:[["app-user-role-edit"]],decls:57,vars:10,consts:[[1,"row"],[1,"col-12","grid-margin"],[1,"card"],[1,"card-body"],["aria-label","breadcrumb",1,""],[1,"breadcrumb","mb-0"],[1,"breadcrumb-item"],[3,"routerLink"],[1,"card","p-4"],[1,"mb-1"],[3,"ngSubmit","formGroup"],[1,"col-12"],[1,"form-group"],[1,"form-label"],["disabled","",1,"form-control",3,"value"],[1,"col-sm-12","col-md-6"],["formControlName","rol",1,"form-select"],["value","Administrador"],["value","Ejecutivo"],[1,"form-check","form-switch"],["type","checkbox","role","switch","id","switchCheckDefault","formControlName","status",1,"form-check-input"],["for","switchCheckDefault",1,"form-check-label"],[1,"wrapp-btn","text-end"],["type","submit",1,"btn","btn-full","--primary","m-1",3,"disabled"]],template:function(s,o){if(1&s&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"nav",4)(5,"ol",5)(6,"li",6)(7,"a",7),e.EFF(8,"Home"),e.k0s()(),e.j41(9,"li",6)(10,"a",7),e.EFF(11,"Management users"),e.k0s()(),e.j41(12,"li",6),e.EFF(13,"Editar Role"),e.k0s()()()()()()(),e.j41(14,"div",0)(15,"div",1)(16,"div",8)(17,"h4",9),e.EFF(18,"Editar Rol del Usuario "),e.k0s(),e.j41(19,"form",10),e.bIt("ngSubmit",function(){return o.onSubmit()}),e.j41(20,"div",0)(21,"div",11)(22,"div",12)(23,"label",13),e.EFF(24,"UID"),e.k0s(),e.nrm(25,"input",14),e.k0s()(),e.j41(26,"div",15)(27,"div",12)(28,"label",13),e.EFF(29,"Email"),e.k0s(),e.nrm(30,"input",14),e.k0s()(),e.j41(31,"div",15)(32,"div",12)(33,"label",13),e.EFF(34,"Nombre"),e.k0s(),e.nrm(35,"input",14),e.k0s()(),e.j41(36,"div",15)(37,"div",12)(38,"label",13),e.EFF(39,"Selecciona el Rol"),e.k0s(),e.j41(40,"select",16)(41,"option",17),e.EFF(42,"Administrador"),e.k0s(),e.j41(43,"option",18),e.EFF(44,"Ejecutivo"),e.k0s()()()(),e.j41(45,"div",15)(46,"div",12)(47,"label",13),e.EFF(48,"Selecciona el Rol"),e.k0s()(),e.j41(49,"div",19),e.nrm(50,"input",20),e.j41(51,"label",21),e.EFF(52),e.k0s()()(),e.j41(53,"div",11)(54,"div",22)(55,"button",23),e.EFF(56," Guardar Cambios "),e.k0s()()()()()()()()),2&s){let i;e.R7$(7),e.Y8G("routerLink",e.lJ4(8,h)),e.R7$(3),e.Y8G("routerLink",e.lJ4(9,E)),e.R7$(9),e.Y8G("formGroup",o.roleForm),e.R7$(6),e.Y8G("value",o.userData.uid),e.R7$(5),e.Y8G("value",o.userData.email),e.R7$(5),e.Y8G("value",o.userData.name+" "+o.userData.last_name),e.R7$(17),e.SpI(" Estatus ",null!=(i=o.roleForm.get("status"))&&i.value?"activo":"inactivo"," usuario "),e.R7$(3),e.Y8G("disabled",o.roleForm.invalid)}},dependencies:[r.X1,r.qT,r.xH,r.y7,r.Zm,r.wz,r.BC,r.cb,r.j4,r.JD,c.Wk],encapsulation:2})}return l})()}}]);