"use strict";(self.webpackChunkclaims_app=self.webpackChunkclaims_app||[]).push([[78],{4078:(y,u,a)=>{a.r(u),a.d(u,{ProfileEditComponent:()=>k});var m=a(2881),i=a(4341),c=a(5207),e=a(1360),f=a(5072),p=a(9885),b=a(4796),g=a(9332),h=a(2107);const v=()=>["/dashboard"],F=()=>["/dashboard/admin-users"];function E(s,D){1&s&&(e.j41(0,"button",87),e.EFF(1,"Guardar cambios"),e.k0s())}let k=(()=>{class s{route;fb;userService;authService;alertService;storage;uid="";profileEditUserForm;userData=null;editMode=!1;isDisabled=!1;loadUserData;loading=!0;isSaving=!1;isLoading=!0;defaultImage="https://randomuser.me/api/portraits/men/40.jpg";previewUrl=null;imageFile=null;fileName="";perfil=null;config=null;constructor(t,o,r,l,n,d){this.route=t,this.fb=o,this.userService=r,this.authService=l,this.alertService=n,this.storage=d,console.log("%c<<< Start constructor >>>","background: #fff3cd; color: #664d03; padding: 2px 5px;")}ngOnInit(){console.log("%c<<< Start ngOnInit >>>","background: #fff3cd; color: #664d03; padding: 2px 5px;"),this.profileEditUserForm=this.fb.group({uid:[{value:"",disabled:!0}],email:[{value:"",disabled:!0}],photoURL:[""],name:[""],last_name:[""],user_name:[""],username:[""],phone:[""],mobile:[""],address:[""],city:[""],commune:[""],profession:[""],website:[""],github:[""],instagram:[""],twitter:[""],facebook:[""],bio:[""]});const t=this.route.snapshot.paramMap.get("uid");console.log("%c<<< UID recibido desde ruta >>>","background: #d1e7dd; color: #0f5132; padding: 2px 5px;",t),t?(this.uid=t,this.isLoading=!0,this.userService.getUserProfile(this.uid).subscribe({next:o=>{if(!o)return console.warn("\u26a0\ufe0f No se encontr\xf3 informaci\xf3n para UID:",this.uid),void(this.isLoading=!1);this.userData=o,this.perfil={...o},this.isLoading=!1,console.log("%c\u2705 Usuario cargado correctamente >>>","background: #198754; color: #fff; padding: 2px 5px;",this.userData),this.profileEditUserForm.patchValue({uid:this.userData.uid||"",email:this.userData.email||"",photoURL:this.userData.photoURL||"",name:this.userData.name||"",last_name:this.userData.last_name||"",user_name:this.userData.user_name||"",username:this.userData.username||"n/a",phone:this.userData.phone||"",mobile:this.userData.mobile||"",address:this.userData.address||"",city:this.userData.city||"",commune:this.userData.commune||"",profession:this.userData.profession||"",website:this.userData.website||"",github:this.userData.github||"",instagram:this.userData.instagram||"",twitter:this.userData.twitter||"",facebook:this.userData.facebook||"",bio:this.userData.bio||""}),console.log("%c<<< Formulario patchValue >>>","background: #d1e7dd; color: #0f5132; padding: 2px 5px;",this.profileEditUserForm.value)},error:o=>{console.error("\u274c Error al cargar usuario desde Firestore:",o),this.isLoading=!1}})):console.error("\u274c No se recibi\xf3 UID en la ruta, no se puede cargar el usuario")}toggleEdit(){this.editMode=!this.editMode,this.isDisabled=!this.isDisabled,console.log("%c<<< Modo edici\xf3n >>>","background: #d1e7dd; color: #0f5132; padding: 2px 5px;",this.editMode)}saveProfile(){if(console.log("%c<<< Guardar perfil >>>","background: #0d6efd; color: #fff; padding: 2px 5px;",this.profileEditUserForm.value),this.profileEditUserForm.invalid)return this.alertService.error("\u26a0\ufe0f El formulario es inv\xe1lido. Revisa los campos."),void this.profileEditUserForm.markAllAsTouched();const t=this.profileEditUserForm.getRawValue();console.log("%c<<< Datos a actualizar >>>","background: #d1e7dd; color: #0f5132; padding: 2px 5px;",t),this.uid?(this.isSaving=!0,console.log("\u{1f504} Guardando cambios en Firestore para UID:",this.uid),this.userService.updateUserProfile(this.uid,t).subscribe({next:()=>{console.log("%c\u2705 Perfil actualizado correctamente","background: #198754; color: #fff; padding: 2px 5px;"),this.alertService.success("Perfil actualizado correctamente \u2705"),this.perfil={...this.perfil,...t},this.isSaving=!1,this.editMode=!1},error:o=>{console.error("%c\u274c Error al actualizar perfil:","background: #f8d7da; color: #842029; padding: 2px 5px;",o),this.alertService.error("\u274c Error al guardar perfil, revisa la consola"),this.isSaving=!1}})):this.alertService.error("\u274c No se encontr\xf3 UID para actualizar.")}onFileSelected(t){const o=t.target;if(o.files&&o.files.length>0){this.imageFile=o.files[0],this.fileName=this.imageFile.name;const r=new FileReader;r.onload=l=>{this.previewUrl=l.target?.result},r.readAsDataURL(this.imageFile)}}static \u0275fac=function(o){return new(o||s)(e.rXU(f.nX),e.rXU(i.ok),e.rXU(p.D),e.rXU(b.u),e.rXU(g.u),e.rXU(h.wc))};static \u0275cmp=e.VBU({type:s,selectors:[["app-profile-edit"]],decls:176,vars:38,consts:[["fileInput",""],[1,"row"],[1,"col-12","text-start","grid-margin"],[1,"card"],[1,"card-body"],[1,"col-12"],["aria-label","breadcrumb",1,""],[1,"breadcrumb","mb-0"],[1,"breadcrumb-item"],[3,"routerLink"],["aria-current","page",1,"breadcrumb-item"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-lg-4","grid-margin"],[1,"card","mb-4"],[1,"card-body","text-center"],[1,"position-relative","d-inline-block"],["alt","Profile Picture","width","120","height","120",1,"rounded-circle","object-fit-cover","profile-pic",3,"src"],["type","file","accept","image/*","hidden","",3,"change"],[1,"btn","btn-primary","btn-sm","position-absolute","bottom-0","end-0","rounded-circle",3,"click"],[1,"fas","fa-camera"],[1,"my-2"],[1,"text-muted","mb-1"],[1,"badge","bg-primary-subtle","text-primary","px-3","py-2","rounded-pill"],[1,"text-muted","mb-2"],[1,"mb-4"],[1,"badge","bg-success-subtle","text-dark","px-3","py-2","rounded-pill"],[1,"d-flex","justify-content-center","mb-2"],["type","button","data-mdb-button-init","","data-mdb-ripple-init","",1,"btn","btn-primary"],["type","button","data-mdb-button-init","","data-mdb-ripple-init","",1,"btn","btn-outline-primary","ms-1"],[1,"list-group","list-group-flush","rounded-3"],[1,"list-group-item","d-flex","justify-content-between","align-items-center","p-3"],[1,"fas","fa-globe","fa-lg","text-warning"],[1,"mb-0"],[1,"fab","fa-github","fa-lg","text-body"],[1,"fab","fa-twitter","fa-lg",2,"color","#55acee"],[1,"fab","fa-instagram","fa-lg",2,"color","#ac2bac"],[1,"fab","fa-facebook-f","fa-lg",2,"color","#3b5998"],[1,"col-lg-8","grid-margin"],[3,"ngSubmit","formGroup"],[1,"row","form-group"],["for","uid",1,"col-sm-3","col-form-label"],[1,"col-sm-9"],["type","text","id","uid","formControlName","uid",1,"form-control",3,"readonly"],["for","email",1,"col-sm-3","col-form-label"],["type","text","id","staticEmail","formControlName","email",1,"form-control-plaintext",3,"readonly"],["for","photoURL",1,"col-sm-3","col-form-label"],["id","photoURL","type","url","formControlName","photoURL","placeholder","https://...",1,"form-control",3,"readonly"],[1,"form-text","text-end"],["href","https://imgur.com/upload","target","_blank"],["for","name",1,"col-sm-3","col-form-label"],["type","text","id","name","formControlName","name",1,"form-control",3,"readonly"],["for","last_name",1,"col-sm-3","col-form-label"],["type","text","id","last_name","formControlName","last_name",1,"form-control",3,"readonly"],["for","user_name",1,"col-sm-3","col-form-label"],["type","text","id","user_name","formControlName","user_name",1,"form-control",3,"readonly"],["type","text","id","username","formControlName","username",1,"form-control",3,"readonly"],["for","phone",1,"col-sm-3","col-form-label"],["type","text","id","phone","formControlName","phone",1,"form-control",3,"readonly"],["for","mobile",1,"col-sm-3","col-form-label"],["type","text","id","mobile","formControlName","mobile",1,"form-control",3,"readonly"],["for","address",1,"col-sm-3","col-form-label"],["type","text","id","address","formControlName","address",1,"form-control",3,"readonly"],[1,"row","g-0"],[1,"col-sm-12","col-md-6"],["for","city",1,"col-sm-6","col-form-label"],[1,"col-sm-6"],["type","text","id","city","formControlName","city",1,"form-control",3,"readonly"],["for","commune",1,"col-sm-3","col-form-label"],["type","text","id","commune","formControlName","commune",1,"form-control",3,"readonly"],["for","profession",1,"col-sm-3","col-form-label"],["type","text","id","profession","formControlName","profession",1,"form-control",3,"readonly"],["for","website",1,"col-sm-3","col-form-label"],["type","text","id","website","formControlName","website",1,"form-control",3,"readonly"],["for","github",1,"col-sm-3","col-form-label"],["type","text","id","github","formControlName","github",1,"form-control",3,"readonly"],["for","instagram",1,"col-sm-3","col-form-label"],["type","text","id","instagram","formControlName","instagram",1,"form-control",3,"readonly"],["for","twitter",1,"col-sm-3","col-form-label"],["type","text","id","twitter","formControlName","twitter",1,"form-control",3,"readonly"],["for","facebook",1,"col-sm-3","col-form-label"],["type","text","id","facebook","formControlName","facebook",1,"form-control",3,"readonly"],["for","bio",1,"col-sm-3","col-form-label"],["rows","4","id","bio","formControlName","bio",1,"form-control",3,"readonly"],[1,"card-footer","py-3"],[1,"wrapp-btn","btn-right"],["type","button",1,"btn","btn-full","m-1",3,"click","ngClass"],["type","submit","class","btn btn-full --success m-1",4,"ngIf"],["type","submit",1,"btn","btn-full","--success","m-1"]],template:function(o,r){if(1&o){const l=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",1)(5,"div",5)(6,"nav",6)(7,"ol",7)(8,"li",8)(9,"a",9),e.EFF(10,"Home"),e.k0s()(),e.j41(11,"li",10)(12,"a",9),e.EFF(13,"Admin Users"),e.k0s()(),e.j41(14,"li",11),e.EFF(15,"Editor de perfil"),e.k0s()()()()()()()()(),e.j41(16,"div",1)(17,"div",12)(18,"div",13)(19,"div",14)(20,"div",15),e.nrm(21,"img",16),e.j41(22,"input",17,0),e.bIt("change",function(d){return e.eBV(l),e.Njj(r.onFileSelected(d))}),e.k0s(),e.j41(24,"button",18),e.bIt("click",function(){e.eBV(l);const d=e.sdS(23);return e.Njj(d.click())}),e.nrm(25,"i",19),e.k0s()(),e.j41(26,"h5",20),e.EFF(27),e.k0s(),e.j41(28,"p",21)(29,"span",22),e.EFF(30),e.k0s()(),e.j41(31,"p",23),e.EFF(32),e.k0s(),e.j41(33,"p",24)(34,"span",25),e.EFF(35),e.k0s()(),e.j41(36,"div",26)(37,"button",27),e.EFF(38,"Follow"),e.k0s(),e.j41(39,"button",28),e.EFF(40,"Message"),e.k0s()()()(),e.j41(41,"div",13)(42,"div",4)(43,"ul",29)(44,"li",30),e.nrm(45,"i",31),e.j41(46,"p",32),e.EFF(47),e.k0s()(),e.j41(48,"li",30),e.nrm(49,"i",33),e.j41(50,"p",32),e.EFF(51),e.k0s()(),e.j41(52,"li",30),e.nrm(53,"i",34),e.j41(54,"p",32),e.EFF(55),e.k0s()(),e.j41(56,"li",30),e.nrm(57,"i",35),e.j41(58,"p",32),e.EFF(59),e.k0s()(),e.j41(60,"li",30),e.nrm(61,"i",36),e.j41(62,"p",32),e.EFF(63),e.k0s()()()()()(),e.j41(64,"div",37)(65,"div",13)(66,"form",38),e.bIt("ngSubmit",function(){return e.eBV(l),e.Njj(r.saveProfile())}),e.j41(67,"div",4)(68,"div",39)(69,"label",40),e.EFF(70,"UID"),e.k0s(),e.j41(71,"div",41),e.nrm(72,"input",42),e.k0s()(),e.j41(73,"div",39)(74,"label",43),e.EFF(75,"Email"),e.k0s(),e.j41(76,"div",41),e.nrm(77,"input",44),e.k0s()(),e.j41(78,"div",39)(79,"label",45),e.EFF(80,"URL foto perfil..."),e.k0s(),e.j41(81,"div",41),e.nrm(82,"input",46),e.j41(83,"div",47),e.EFF(84,"Pega una URL de imagen p\xfablica (por ejemplo desde "),e.j41(85,"a",48),e.EFF(86,"Imgur"),e.k0s(),e.EFF(87,")"),e.k0s()()(),e.j41(88,"div",39)(89,"label",49),e.EFF(90,"Nombres"),e.k0s(),e.j41(91,"div",41),e.nrm(92,"input",50),e.k0s()(),e.j41(93,"div",39)(94,"label",51),e.EFF(95,"Apellidos"),e.k0s(),e.j41(96,"div",41),e.nrm(97,"input",52),e.k0s()(),e.j41(98,"div",39)(99,"label",53),e.EFF(100,"Username"),e.k0s(),e.j41(101,"div",41),e.nrm(102,"input",54),e.k0s()(),e.j41(103,"div",39)(104,"label",53),e.EFF(105,"Username"),e.k0s(),e.j41(106,"div",41),e.nrm(107,"input",55),e.k0s()(),e.j41(108,"div",39)(109,"label",56),e.EFF(110,"Tel\xe9fono"),e.k0s(),e.j41(111,"div",41),e.nrm(112,"input",57),e.k0s()(),e.j41(113,"div",39)(114,"label",58),e.EFF(115,"Celular"),e.k0s(),e.j41(116,"div",41),e.nrm(117,"input",59),e.k0s()(),e.j41(118,"div",39)(119,"label",60),e.EFF(120,"Direcci\xf3n"),e.k0s(),e.j41(121,"div",41),e.nrm(122,"input",61),e.k0s()(),e.j41(123,"div",62)(124,"div",63)(125,"div",39)(126,"label",64),e.EFF(127,"Ciudad"),e.k0s(),e.j41(128,"div",65),e.nrm(129,"input",66),e.k0s()()(),e.j41(130,"div",63)(131,"div",39)(132,"label",67),e.EFF(133,"Comuna"),e.k0s(),e.j41(134,"div",41),e.nrm(135,"input",68),e.k0s()()()(),e.j41(136,"div",39)(137,"label",69),e.EFF(138,"Profesi\xf3n"),e.k0s(),e.j41(139,"div",41),e.nrm(140,"input",70),e.k0s()(),e.j41(141,"div",39)(142,"label",71),e.EFF(143,"Sitio Web"),e.k0s(),e.j41(144,"div",41),e.nrm(145,"input",72),e.k0s()(),e.j41(146,"div",39)(147,"label",73),e.EFF(148,"GitHub"),e.k0s(),e.j41(149,"div",41),e.nrm(150,"input",74),e.k0s()(),e.j41(151,"div",39)(152,"label",75),e.EFF(153,"Instagram"),e.k0s(),e.j41(154,"div",41),e.nrm(155,"input",76),e.k0s()(),e.j41(156,"div",39)(157,"label",77),e.EFF(158,"Twitter"),e.k0s(),e.j41(159,"div",41),e.nrm(160,"input",78),e.k0s()(),e.j41(161,"div",39)(162,"label",79),e.EFF(163,"Facebook"),e.k0s(),e.j41(164,"div",41),e.nrm(165,"input",80),e.k0s()(),e.j41(166,"div",39)(167,"label",81),e.EFF(168,"Biograf\xeda"),e.k0s(),e.j41(169,"div",41),e.nrm(170,"textarea",82),e.k0s()()(),e.j41(171,"div",83)(172,"div",84)(173,"button",85),e.bIt("click",function(){return e.eBV(l),e.Njj(r.toggleEdit())}),e.EFF(174),e.k0s(),e.DNE(175,E,2,0,"button",86),e.k0s()()()()()()}2&o&&(e.R7$(9),e.Y8G("routerLink",e.lJ4(36,v)),e.R7$(3),e.Y8G("routerLink",e.lJ4(37,F)),e.R7$(9),e.Y8G("src",(null==r.userData?null:r.userData.photoURL)||r.defaultImage,e.B4B),e.R7$(6),e.JRh((null==r.userData?null:r.userData.name)+" "+(null==r.userData?null:r.userData.last_name)||"N/A"),e.R7$(3),e.JRh((null==r.userData?null:r.userData.profession)||"N/A"),e.R7$(2),e.Lme("",(null==r.userData?null:r.userData.address)||"N/A",", ",(null==r.userData?null:r.userData.city)||"N/A",""),e.R7$(3),e.SpI(" ",(null==r.userData?null:r.userData.uid)||"N/A"," "),e.R7$(12),e.JRh((null==r.userData?null:r.userData.website)||"N/A"),e.R7$(4),e.JRh((null==r.userData?null:r.userData.github)||"N/A"),e.R7$(4),e.JRh((null==r.userData?null:r.userData.twitter)||"N/A"),e.R7$(4),e.JRh((null==r.userData?null:r.userData.instagram)||"N/A"),e.R7$(4),e.JRh((null==r.userData?null:r.userData.facebook)||"N/A"),e.R7$(3),e.Y8G("formGroup",r.profileEditUserForm),e.R7$(6),e.Y8G("readonly",!r.editMode),e.R7$(5),e.Y8G("readonly",!r.editMode),e.R7$(5),e.Y8G("readonly",!r.editMode),e.R7$(10),e.Y8G("readonly",!r.editMode),e.R7$(5),e.Y8G("readonly",!r.editMode),e.R7$(5),e.Y8G("readonly",!r.editMode),e.R7$(5),e.Y8G("readonly",!r.editMode),e.R7$(5),e.Y8G("readonly",!r.editMode),e.R7$(5),e.Y8G("readonly",!r.editMode),e.R7$(5),e.Y8G("readonly",!r.editMode),e.R7$(7),e.Y8G("readonly",!r.editMode),e.R7$(6),e.Y8G("readonly",!r.editMode),e.R7$(5),e.Y8G("readonly",!r.editMode),e.R7$(5),e.Y8G("readonly",!r.editMode),e.R7$(5),e.Y8G("readonly",!r.editMode),e.R7$(5),e.Y8G("readonly",!r.editMode),e.R7$(5),e.Y8G("readonly",!r.editMode),e.R7$(5),e.Y8G("readonly",!r.editMode),e.R7$(5),e.Y8G("readonly",!r.editMode),e.R7$(3),e.Y8G("ngClass",r.editMode?"--danger":"--primary"),e.R7$(),e.SpI(" ",r.editMode?"Cancelar edici\xf3n":"Editar perfil"," "),e.R7$(),e.Y8G("ngIf",r.editMode))},dependencies:[m.MD,m.YU,m.bT,i.YN,i.qT,i.me,i.BC,i.cb,i.X1,i.j4,i.JD,c.iI,c.Wk],encapsulation:2})}return s})()}}]);