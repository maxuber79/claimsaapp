import{a as Ae,b as ue,c as pe,d as De}from"./chunk-RX7VPE6A.js";import{i as W}from"./chunk-VYWRVR3S.js";import{a as B}from"./chunk-34SF47SS.js";import{a as ae}from"./chunk-5Z7HKXYQ.js";import"./chunk-2BL6JQEY.js";import{a as R}from"./chunk-N6RA7QK6.js";import{b as z,c as k,d as q,e as G,f as ke,g as le,h as H,j as se,k as ce,l as $,m as K,n as X,o as Fe,p as de,q as Y,r as me}from"./chunk-5RABQZIW.js";import"./chunk-3OADCOYV.js";import{Ba as _,D as ye,Da as g,Ea as m,G as Te,Ha as T,Ja as r,Ka as C,L as u,La as w,M as p,Ma as F,Na as x,Oa as b,Pa as E,Ta as ie,Ua as A,Va as ne,Wa as Ie,Xa as oe,Za as D,_a as N,a as I,aa as te,b as Z,ba as s,fa as h,g as y,h as ee,ha as M,ib as U,jb as j,kb as V,la as f,lb as O,mb as P,n as Ee,pb as Me,sa as c,sb as Ve,t as Se,ta as n,u as J,ua as i,ub as Pe,va as v,vb as re,x as we,xb as L}from"./chunk-5TBBY7BX.js";var Re=(a,t)=>({"bg-success-subtle":a,"":t}),Be=a=>({"fw-bold":!0,"completed-text":a}),We=a=>({"completed-text":a}),ze=(a,t,e)=>({"text-bg-danger":a,"text-bg-warning":t,"text-bg-secondary":e}),qe=(a,t)=>({"bg-success":a,"bg-danger":t}),Ge=(a,t)=>({"btn-warning":a,"btn-outline-success":t});function He(a,t){a&1&&(n(0,"div",29),r(1," El t\xEDtulo es obligatorio. "),i())}function $e(a,t){a&1&&v(0,"i",45)}function Ke(a,t){if(a&1){let e=_();n(0,"li",30)(1,"div",31)(2,"div",32),f(3,$e,1,0,"i",33),r(4),i(),n(5,"small",34),r(6),i(),v(7,"br"),n(8,"span",35),r(9),i(),n(10,"span",36),r(11),D(12,"date"),i(),n(13,"span",37),r(14),i()(),n(15,"div",38)(16,"span",39),r(17),i(),n(18,"button",40),g("click",function(){let o=u(e).$implicit,d=m();return p(d.deleteTodo(o.id))}),v(19,"i",24),r(20," Eliminar "),i(),n(21,"button",41),g("click",function(){let o=u(e).$implicit,d=m();return p(d.toggleComplete(o))}),v(22,"i",42),r(23),i(),n(24,"button",43),g("click",function(){let o=u(e).$implicit,d=m();return p(d.editTodo(o.id))}),v(25,"i",44),r(26," Editar "),i()()()}if(a&2){let e=t.$implicit;c("ngClass",ne(17,Re,e.completed,!e.completed)),s(2),c("ngClass",A(20,Be,e.completed)),s(),c("ngIf",e.completed),s(),C(e.title),s(),c("ngClass",A(22,We,e.completed)),s(),C(e.description),s(2),c("ngClass",Ie(24,ze,e.priority==="high",e.priority==="medium",e.priority==="low")),s(),C(e.priority==="high"?"Alta":e.priority==="medium"?"Media":e.priority==="low"?"Baja":"Desconocida"),s(2),C(N(12,14,e.dueDate,"shortDate")),s(3),C(e.id),s(2),c("ngClass",ne(28,qe,e.completed,!e.completed)),s(),w(" ",e.completed?"Completada":"Pendiente"," "),s(4),c("ngClass",ne(31,Ge,e.completed,!e.completed)),s(2),w(" ",e.completed?"Desmarcar":"Completar"," ")}}var ge=class a{constructor(t,e,l,o,d,S){this.todoService=t;this.alertService=e;this.fb=l;this.authService=o;this.route=d;this.router=S;console.log("%c<<< Constructor TODO-LIST >>>","background: #fff3cd; color: #664d03; padding: 2px 5px;"),this.todoForm=this.fb.group({title:["",[k.required,k.minLength(3)]],description:[""],dueDate:[null],priority:["",k.required]})}todoForm;todos=[];otraCondicion=!0;condicion=!0;ngOnInit(){return y(this,null,function*(){console.log("%c<<< ngOnInit TODO-LIST >>>","background: #6610f2; color: #ffffff; padding: 2px 5px;");let t=yield Se(this.authService.getCurrentUser());if(!t||!t.uid){this.alertService.error("Usuario no autenticado"),console.error("\u274C Usuario no autenticado");return}console.log("\u{1F7E2} Usuario autenticado:",t.uid),this.todoService.getTodos().subscribe(e=>{this.todos=e,console.log("\u{1F4CB} Tareas recibidas:",this.todos)})})}onSubmit(){return y(this,null,function*(){if(this.todoForm.invalid){this.todoForm.markAllAsTouched(),this.alertService.warning("Por favor, completa todos los campos requeridos.");return}let t=this.todoForm.value;console.log("%c\u{1F4E4} Enviando tarea a Firestore:","color: #0d6efd",t);try{console.log("\u{1F4E4} Enviando tarea al servicio TodoService..."),yield this.todoService.addTodo({title:t.title,description:t.description,dueDate:t.dueDate,priority:t.priority}),this.alertService.success("Tu tarea fue guardada correctamente"),console.log("%c\u2705 Tarea guardada con \xE9xito","color: #198754"),this.todoForm.reset()}catch(e){this.alertService.error("Ocurri\xF3 un error al guardar la tarea"),console.error("%c\u274C Error al guardar tarea:","color: red",e?.message??e)}})}deleteTodo(t){return y(this,null,function*(){if((yield this.alertService.confirm("\xBFDeseas eliminar esta tarea?")).isConfirmed)try{yield this.todoService.deleteTodo(t),this.alertService.success("Tarea eliminada correctamente")}catch(l){console.error("\u274C Error al eliminar tarea:",l),this.alertService.error("No se pudo eliminar la tarea")}})}toggleComplete(t){return y(this,null,function*(){try{let e=!t.completed;yield this.todoService.updateTodo(t.id,{completed:e}),e?this.alertService.showToastSuccess("Marcado como completado","\xC9xito"):this.alertService.showToastWarning("Marcado como pendiente","Atenci\xF3n")}catch(e){this.alertService.showToastError("No se pudo actualizar el estado","Error"),console.error(e)}})}clearAll(){return y(this,null,function*(){if((yield this.alertService.confirm("\xBFEliminar todas las tareas?")).isConfirmed)try{yield this.todoService.clearAllTodos(),this.alertService.success("Todas las tareas fueron eliminadas")}catch(e){console.error("\u274C Error al limpiar tareas:",e),this.alertService.error("No se pudieron eliminar las tareas")}})}editTodo(t){this.router.navigate(["/dashboard/todo-list/todo-edit/",t])}testAlert(){this.alertService.showToastSuccess("\xA1Todo sali\xF3 bien!","\xC9xito"),console.log("%c\u2139\uFE0F Alerta de informaci\xF3n mostrada","color: #0dcaf0")}static \u0275fac=function(e){return new(e||a)(h(Ae),h(W),h(de),h(R),h(Ve),h(Pe))};static \u0275cmp=M({type:a,selectors:[["app-todo-list"]],decls:49,vars:6,consts:[[1,"row"],[1,"col-12"],[1,"my-4"],[1,"col-12","border","p-3","mb-5","bg-light","rounded-1"],[1,"row","g-3",3,"ngSubmit","formGroup"],[1,"col-md-6"],["for","title",1,"form-label"],["type","text","formControlName","title","id","title",1,"form-control"],["class","invalid-feedback",4,"ngIf"],["for","description",1,"form-label"],["type","text","formControlName","description","id","description",1,"form-control"],["for","dueDate",1,"form-label"],["type","date","formControlName","dueDate","id","dueDate",1,"form-control"],["for","priority",1,"form-label"],["formControlName","priority","id","priority",1,"form-select"],["value","","disabled",""],["value","low"],["value","medium"],["value","high"],[1,"col-12","text-end"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"mb-3"],[1,"col-12","p-3","text-end"],[1,"btn","btn-danger",3,"click"],[1,"bi","bi-trash3-fill"],[1,"btn","btn-success","mx-2",3,"click"],[1,"bi","bi-bell-fill"],[1,"list-group"],["class","list-group-item d-flex flex-wrap flex-md-nowrap justify-content-between align-items-center align-items-md-center gap-3",3,"ngClass",4,"ngFor","ngForOf"],[1,"invalid-feedback"],[1,"list-group-item","d-flex","flex-wrap","flex-md-nowrap","justify-content-between","align-items-center","align-items-md-center","gap-3",3,"ngClass"],[1,"text-start","flex-grow-1","me-3","todo-content"],[1,"fw-bold",3,"ngClass"],["class","bi bi-check-circle-fill text-success me-1",4,"ngIf"],[1,"text-muted",3,"ngClass"],[1,"badge","me-2",3,"ngClass"],[1,"badge","text-bg-light","text-dark"],[1,"badge","text-bg-primary","ms-2"],[1,"d-flex","flex-wrap","align-items-center","justify-content-end","gap-2","todo-actions"],[1,"badge",3,"ngClass"],[1,"btn","btn-sm","btn-outline-danger","ms-2",3,"click"],[1,"btn","btn-sm","ms-2",3,"click","ngClass"],[1,"bi","bi-check"],[1,"btn","btn-sm","btn-outline-primary","ms-2",3,"click"],[1,"bi","bi-pencil-square"],[1,"bi","bi-check-circle-fill","text-success","me-1"]],template:function(e,l){if(e&1&&(n(0,"div",0)(1,"div",1)(2,"h2",2),r(3,"Agregar nueva tarea"),i()(),n(4,"div",3)(5,"form",4),g("ngSubmit",function(){return l.onSubmit()}),n(6,"div",5)(7,"label",6),r(8,"T\xEDtulo"),i(),v(9,"input",7),f(10,He,2,0,"div",8),i(),n(11,"div",5)(12,"label",9),r(13,"Descripci\xF3n"),i(),v(14,"input",10),i(),n(15,"div",5)(16,"label",11),r(17,"Fecha l\xEDmite"),i(),v(18,"input",12),i(),n(19,"div",5)(20,"label",13),r(21,"Prioridad"),i(),n(22,"select",14)(23,"option",15),r(24,"Selecciona prioridad"),i(),n(25,"option",16),r(26,"Baja"),i(),n(27,"option",17),r(28,"Media"),i(),n(29,"option",18),r(30,"Alta"),i()()(),n(31,"div",19)(32,"button",20),r(33,"Guardar tarea"),i()()()()(),v(34,"hr",2),n(35,"div",0)(36,"div",1)(37,"h2",21),r(38,"Tareas registradas"),i()(),n(39,"div",22)(40,"button",23),g("click",function(){return l.clearAll()}),v(41,"i",24),r(42," Eliminar todas las tareas "),i(),n(43,"button",25),g("click",function(){return l.testAlert()}),v(44,"i",26),r(45," prueba de alert toast "),i()(),n(46,"div",1)(47,"ul",27),f(48,Ke,27,34,"li",28),i()()()),e&2){let o,d;s(5),c("formGroup",l.todoForm),s(4),T("is-invalid",((o=l.todoForm.get("title"))==null?null:o.invalid)&&((o=l.todoForm.get("title"))==null?null:o.touched)),s(),c("ngIf",((d=l.todoForm.get("title"))==null?null:d.invalid)&&((d=l.todoForm.get("title"))==null?null:d.touched)),s(22),c("disabled",l.todoForm.invalid),s(16),c("ngForOf",l.todos)}},dependencies:[P,U,j,V,Y,H,K,X,z,$,q,G,me,se,ce,L,O],styles:['@charset "UTF-8";.completed-text[_ngcontent-%COMP%]{color:#6c757d;text-decoration:line-through;transition:color .3s ease,text-decoration .3s ease}.todo-content[_ngcontent-%COMP%]{min-width:0}.todo-actions[_ngcontent-%COMP%]{flex-shrink:0;white-space:nowrap}@media (max-width: 768px){.todo-actions[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch;width:100%}.todo-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:100%}}']})};var Je=()=>["/dashboard"],Qe=(a,t,e,l)=>({"bg-primary":a,"bg-warning text-dark":t,"bg-danger":e,"bg-success":l});function Ze(a,t){a&1&&(n(0,"div",18)(1,"div",19)(2,"span",20),r(3,"Loading..."),i()()())}function et(a,t){if(a&1&&(n(0,"div")(1,"div",2)(2,"div",3)(3,"div",21)(4,"div",22),v(5,"img",23),i(),n(6,"div",24)(7,"h2",25),r(8),i(),n(9,"h6",25),r(10,"Bienvenido a tu aplicaci\xF3n"),i(),n(11,"p",26),r(12,"Este es tu panel de control, aqu\xED puedes administrar tus tareas, ver estad\xEDsticas y m\xE1s."),i(),n(13,"p",26)(14,"span",27),r(15),i()()()()()()()),a&2){let e=m();s(5),c("src",e.userData.photoURL||e.imageDefault,te),s(3),w("Hola, ",e.userData.name||"Invitado"),s(7),C(e.userData.rol||"Desconocido")}}function tt(a,t){if(a&1&&(n(0,"div",28),v(1,"app-card-metric",29),i()),a&2){let e=t.$implicit;s(),c("icon",e.icon)("count",e.count)("label",e.label)("color",e.color)("footerText",e.footerText)("trendIcon",e.trendIcon)}}function it(a,t){a&1&&(n(0,"div",18)(1,"div",19)(2,"span",20),r(3,"Cargando..."),i()()())}function nt(a,t){if(a&1&&(n(0,"div",30)(1,"div",31),r(2),i()()),a&2){let e=m();s(2),w(" ",e.errorMessage," ")}}function ot(a,t){if(a&1&&(n(0,"option",64),r(1),i()),a&2){let e=t.$implicit;c("value",e.uid),s(),F(" ",e.name," ",e.last_name," ")}}function rt(a,t){a&1&&(n(0,"tr")(1,"td",72),r(2,"No se encontraron reclamos con los filtros aplicados."),i()())}function at(a,t){if(a&1){let e=_();n(0,"tr")(1,"td")(2,"input",60),g("change",function(){let o=u(e).$implicit,d=m(2);return p(d.toggleClaimSelection(o))}),i()(),n(3,"td"),r(4),i(),n(5,"td"),r(6),i(),n(7,"td"),r(8),D(9,"date"),i(),n(10,"td")(11,"span",73),r(12),i()(),n(13,"td"),r(14),i(),n(15,"td")(16,"button",74),g("click",function(){let o=u(e).$implicit,d=m(2);return p(d.openViewEditModal(o,!0))}),v(17,"i",75),r(18," Ver/Editar "),i()()()}if(a&2){let e=t.$implicit,l=m(2);s(2),c("checked",e.selected),s(2),C(e.nombre),s(2),C(e.tipo),s(2),C(N(9,7,e.fecha,"shortDate")),s(3),c("ngClass",oe(10,Qe,e.estado==="Iniciado",e.estado==="Pendiente",e.estado==="Cancelado",e.estado==="Cerrado")),s(),w(" ",e.estado," "),s(2),w(" ",l.getExecutiveName(e.uidEjecutivo)," ")}}function lt(a,t){if(a&1){let e=_();n(0,"li",69)(1,"a",70),g("click",function(){let o=u(e).$implicit,d=m(2);return p(d.onPageChange(o))}),r(2),i()()}if(a&2){let e=t.$implicit,l=m(2);T("active",e===l.currentPage),s(2),C(e)}}function st(a,t){if(a&1){let e=_();n(0,"div",0)(1,"div",32)(2,"h2",33),r(3,"Administraci\xF3n de Reclamaciones"),i(),n(4,"p",34),r(5,"Aqu\xED puedes gestionar todas las reclamaciones de los usuarios."),i()(),n(6,"div",35)(7,"button",36),g("click",function(){u(e);let o=m();return p(o.openNewModal())}),v(8,"i",37),r(9," Nuevo Reclamo "),i(),n(10,"button",38),g("click",function(){u(e);let o=m();return p(o.deleteSelectedClaims())}),v(11,"i",39),r(12," Eliminar Seleccionados "),i()(),n(13,"div",40)(14,"div",41)(15,"div",42)(16,"label",43),r(17,"Buscar por Nombre"),i(),n(18,"input",44),E("ngModelChange",function(o){u(e);let d=m();return b(d.searchTerm,o)||(d.searchTerm=o),p(o)}),g("input",function(){u(e);let o=m();return p(o.applyFilters())}),i()(),n(19,"div",42)(20,"label",45),r(21,"Filtrar por Estado"),i(),n(22,"select",46),E("ngModelChange",function(o){u(e);let d=m();return b(d.filterStatus,o)||(d.filterStatus=o),p(o)}),g("change",function(){u(e);let o=m();return p(o.applyFilters())}),n(23,"option",47),r(24,"Todos los Estados"),i(),n(25,"option",48),r(26,"Iniciado"),i(),n(27,"option",49),r(28,"Pendiente"),i(),n(29,"option",50),r(30,"Cancelado"),i(),n(31,"option",51),r(32,"Cerrado"),i()()(),n(33,"div",42)(34,"label",52),r(35,"Filtrar por Ejecutivo"),i(),n(36,"select",53),E("ngModelChange",function(o){u(e);let d=m();return b(d.selectedExecutiveUid,o)||(d.selectedExecutiveUid=o),p(o)}),g("change",function(){u(e);let o=m();return p(o.applyFilters())}),n(37,"option",54),r(38,"Todos los Ejecutivos"),i(),f(39,ot,2,3,"option",55),i()(),n(40,"div",42)(41,"button",56),g("click",function(){u(e);let o=m();return p(o.resetData())}),v(42,"i",57),r(43," Limpiar "),i()()()(),n(44,"div",30)(45,"div",58)(46,"table",59)(47,"thead")(48,"tr")(49,"th")(50,"input",60),g("change",function(){u(e);let o=m();return p(o.toggleMasterCheckbox())}),i()(),n(51,"th"),r(52,"Nombre"),i(),n(53,"th"),r(54,"Tipo"),i(),n(55,"th"),r(56,"Fecha"),i(),n(57,"th"),r(58,"Estado"),i(),n(59,"th"),r(60,"Ejecutivo Asignado"),i(),n(61,"th"),r(62,"Acciones"),i()()(),n(63,"tbody"),f(64,rt,3,0,"tr",12)(65,at,19,15,"tr",61),i()()()(),n(66,"div",62)(67,"p",34),r(68,"Elementos por p\xE1gina: "),n(69,"select",63),g("change",function(o){u(e);let d=m();return p(d.onItemsPerPageChange(o))}),n(70,"option",64),r(71,"10"),i(),n(72,"option",64),r(73,"25"),i(),n(74,"option",64),r(75,"50"),i(),n(76,"option",64),r(77,"100"),i()()(),n(78,"span",65),r(79),i()(),n(80,"div",66)(81,"nav",67)(82,"ul",68)(83,"li",69)(84,"a",70),g("click",function(){u(e);let o=m();return p(o.onPageChange(o.currentPage-1))}),r(85,"Anterior"),i()(),f(86,lt,3,3,"li",71),n(87,"li",69)(88,"a",70),g("click",function(){u(e);let o=m();return p(o.onPageChange(o.currentPage+1))}),r(89,"Siguiente"),i()()()()()()}if(a&2){let e=m();s(10),c("disabled",!e.showDeleteButton),s(8),x("ngModel",e.searchTerm),s(4),x("ngModel",e.filterStatus),s(14),x("ngModel",e.selectedExecutiveUid),s(3),c("ngForOf",e.executives),s(11),c("checked",e.masterChecked),s(14),c("ngIf",e.pagedClaims.length===0),s(),c("ngForOf",e.pagedClaims),s(4),c("ngModel",e.itemsPerPage),s(),c("value",10),s(2),c("value",25),s(2),c("value",50),s(2),c("value",100),s(3),F(" P\xE1gina ",e.currentPage," de ",e.getTotalPages()," "),s(4),T("disabled",e.currentPage===1),s(3),c("ngForOf",e.getPagesArray()),s(),T("disabled",e.currentPage===e.getTotalPages())}}function ct(a,t){if(a&1&&(n(0,"span",90),r(1),i()),a&2){let e=m(2);s(),C(e.selectedClaim==null?null:e.selectedClaim.id)}}function dt(a,t){if(a&1&&(n(0,"option",64),r(1),i()),a&2){let e=t.$implicit;c("value",e.uid),s(),F(" ",e.name+" "+e.last_name," - ",e.email," ")}}function mt(a,t){if(a&1){let e=_();n(0,"form",91)(1,"div",92)(2,"label",93),r(3,"Nombre"),i(),n(4,"input",94),E("ngModelChange",function(o){u(e);let d=m(2);return b(d.selectedClaim.nombre,o)||(d.selectedClaim.nombre=o),p(o)}),i()(),n(5,"div",92)(6,"label",93),r(7,"Asunto"),i(),n(8,"input",95),E("ngModelChange",function(o){u(e);let d=m(2);return b(d.selectedClaim.tipo,o)||(d.selectedClaim.tipo=o),p(o)}),i()(),n(9,"div",92)(10,"label",93),r(11,"Estado"),i(),n(12,"select",96),E("ngModelChange",function(o){u(e);let d=m(2);return b(d.selectedClaim.estado,o)||(d.selectedClaim.estado=o),p(o)}),n(13,"option",48),r(14,"Iniciado"),i(),n(15,"option",49),r(16,"Pendiente"),i(),n(17,"option",50),r(18,"Cancelado"),i(),n(19,"option",51),r(20,"Cerrado"),i()()(),n(21,"div",92)(22,"label",93),r(23,"Fecha"),i(),n(24,"input",97),E("ngModelChange",function(o){u(e);let d=m(2);return b(d.selectedClaim.fecha,o)||(d.selectedClaim.fecha=o),p(o)}),i()(),n(25,"div",92)(26,"label",93),r(27,"Ejecutivo Asignado"),i(),n(28,"select",98),E("ngModelChange",function(o){u(e);let d=m(2);return b(d.selectedClaim.uidEjecutivo,o)||(d.selectedClaim.uidEjecutivo=o),p(o)}),f(29,dt,2,3,"option",55),i()(),n(30,"div",4)(31,"label",93),r(32,"Descripci\xF3n"),i(),n(33,"textarea",99),E("ngModelChange",function(o){u(e);let d=m(2);return b(d.selectedClaim.detail,o)||(d.selectedClaim.detail=o),p(o)}),i()()()}if(a&2){let e=m(2);s(4),x("ngModel",e.selectedClaim.nombre),c("disabled",e.isViewOnly),s(4),x("ngModel",e.selectedClaim.tipo),c("disabled",e.isViewOnly),s(4),x("ngModel",e.selectedClaim.estado),c("disabled",e.isViewOnly),s(12),x("ngModel",e.selectedClaim.fecha),c("disabled",e.isViewOnly),s(4),x("ngModel",e.selectedClaim.uidEjecutivo),c("disabled",e.isViewOnly),s(),c("ngForOf",e.executives),s(4),x("ngModel",e.selectedClaim.detail),c("disabled",e.isViewOnly)}}function ut(a,t){a&1&&(n(0,"div",100),r(1," No se ha cargado ning\xFAn reclamo para ver/editar. "),i())}function pt(a,t){if(a&1){let e=_();n(0,"button",101),g("click",function(){u(e);let o=m(2);return p(o.enableEdit())}),v(1,"i",102),r(2," Habilitar Edici\xF3n "),i()}}function gt(a,t){if(a&1){let e=_();n(0,"button",103),g("click",function(){u(e);let o=m(2);return p(o.saveChanges())}),v(1,"i",104),r(2," Guardar Cambios "),i()}if(a&2){let e=m(2);c("disabled",!e.isEditing)}}function vt(a,t){if(a&1){let e=_();n(0,"div",76)(1,"div",77)(2,"div",78)(3,"div",79)(4,"h5",80),r(5),f(6,ct,2,1,"span",81),i(),n(7,"button",82),g("click",function(){u(e);let o=m();return p(o.cancelEdit())}),i()(),n(8,"div",83),f(9,mt,34,13,"form",84)(10,ut,2,0,"div",85),i(),n(11,"div",86)(12,"button",87),g("click",function(){u(e);let o=m();return p(o.cancelEdit())}),r(13,"Cerrar"),i(),f(14,pt,3,0,"button",88)(15,gt,3,1,"button",89),i()()()()}if(a&2){let e=m();s(5),w(" ",e.isEditing?"Editar Reclamo":"Ver Reclamo"," "),s(),c("ngIf",e.selectedClaim==null?null:e.selectedClaim.id),s(3),c("ngIf",e.selectedClaim),s(),c("ngIf",!e.selectedClaim),s(4),c("ngIf",!e.isEditing),s(),c("ngIf",e.isEditing)}}function ft(a,t){if(a&1&&(n(0,"option",64),r(1),i()),a&2){let e=t.$implicit;c("value",e.uid),s(),F(" ",e.name+" "+e.last_name," - ",e.email," ")}}function ht(a,t){if(a&1){let e=_();n(0,"div",76)(1,"div",105)(2,"div",106)(3,"div",79)(4,"h5",80),r(5,"Nuevo Reclamo"),i(),n(6,"button",82),g("click",function(){u(e);let o=m();return p(o.cancelNewClaim())}),i()(),n(7,"div",83)(8,"form",91)(9,"div",92)(10,"label",93),r(11,"Nombre"),i(),n(12,"input",107),E("ngModelChange",function(o){u(e);let d=m();return b(d.newClaim.nombre,o)||(d.newClaim.nombre=o),p(o)}),i()(),n(13,"div",92)(14,"label",93),r(15,"Asunto"),i(),n(16,"input",108),E("ngModelChange",function(o){u(e);let d=m();return b(d.newClaim.tipo,o)||(d.newClaim.tipo=o),p(o)}),i()(),n(17,"div",4)(18,"label",93),r(19,"Descripci\xF3n"),i(),n(20,"textarea",109),E("ngModelChange",function(o){u(e);let d=m();return b(d.newClaim.detail,o)||(d.newClaim.detail=o),p(o)}),i()(),n(21,"div",92)(22,"label",93),r(23,"Fecha"),i(),n(24,"input",110),E("ngModelChange",function(o){u(e);let d=m();return b(d.newClaim.fecha,o)||(d.newClaim.fecha=o),p(o)}),i()(),n(25,"div",111)(26,"label",93),r(27,"Asignar a Ejecutivo"),i(),n(28,"select",112),E("ngModelChange",function(o){u(e);let d=m();return b(d.selectedExecutiveUid,o)||(d.selectedExecutiveUid=o),p(o)}),n(29,"option",113),r(30,"Selecciona un ejecutivo"),i(),f(31,ft,2,3,"option",55),i()()()(),n(32,"div",86)(33,"button",114),g("click",function(){u(e);let o=m();return p(o.showNewModal=!1)}),r(34,"Cancelar"),i(),n(35,"button",115),g("click",function(){u(e);let o=m();return p(o.saveNewClaim())}),r(36,"Crear Reclamo"),i()()()()()}if(a&2){let e=m();s(12),x("ngModel",e.newClaim.nombre),s(4),x("ngModel",e.newClaim.tipo),s(4),x("ngModel",e.newClaim.detail),s(4),x("ngModel",e.newClaim.fecha),s(4),x("ngModel",e.selectedExecutiveUid),s(),c("ngValue",""),s(2),c("ngForOf",e.executives)}}var fe=class a{constructor(t,e,l,o,d){this.claimsService=t;this.userService=e;this.alert=l;this.authService=o;this.notificationService=d}userUid=null;userData=null;allClaims=[];filteredClaims=[];pagedClaims=[];isLoading=!0;errorMessage=null;subscriptions=new ee;executives=[];selectedExecutiveUid="";searchTerm="";filterStatus="Todos";currentPage=1;itemsPerPage=10;masterChecked=!1;showDeleteButton=!1;showNewModal=!1;newClaim=this.getEmptyClaim();selectedClaim=null;isViewOnly=!1;showModal=!1;isEditing=!1;imageDefault="https://randomuser.me/api/portraits/men/40.jpg";metrics=[];claims=[];ngOnInit(){this.authService.getCurrentUser().subscribe(t=>{t&&(this.userUid=t.uid,console.log("\u{1F4E6} Usuario autenticado:",this.userUid),this.userService.getUserProfile(this.userUid).subscribe({next:e=>{this.userData=e||null,console.log("%c<<< infoData | dashboard >>>","background: #198754; color: #fff; padding: 2px 5px;",this.userData)},error:e=>{console.error("\u274C Error al cargar perfil de usuario:",e)}}))}),this.loadExecutives(),this.loadAllClaims()}sendTestNotification(t){if(console.log("\u{1F514} Enviando notificaci\xF3n al ejecutivo UID:",t),!t){console.warn("\u26A0\uFE0F UID del ejecutivo no est\xE1 definido. No se puede enviar notificaci\xF3n.");return}let e=`Se te asign\xF3 el reclamo: ${this.newClaim?.nombre||"sin nombre"}`;this.notificationService.sendToUser(t,e,"asignado").then(()=>console.log(`\u2705 Notificaci\xF3n enviada al ejecutivo: ${t}`)).catch(l=>console.error("\u274C Error al enviar notificaci\xF3n:",l))}loadExecutives(){let t=this.userService.getExecutives().subscribe({next:e=>{this.executives=e,console.log("\u2705 Ejecutivos cargados:",this.executives)},error:e=>{console.error("\u274C Error al cargar ejecutivos:",e),this.alert.error("No se pudieron cargar los ejecutivos.")}});this.subscriptions.add(t)}loadAllClaims(){this.isLoading=!0,this.errorMessage=null;let t=this.claimsService.getAllClaims().subscribe({next:e=>{this.allClaims=e.map(l=>Z(I({},l),{selected:!1})),console.log("\u2705 Todos los reclamos cargados:",this.allClaims),this.isLoading=!1,this.applyFilters(),this.claims=[...this.allClaims],this.updateMetrics()},error:e=>{console.error("\u274C Error al cargar todos los reclamos:",e),this.errorMessage="No se pudieron cargar los reclamos. Int\xE9ntalo de nuevo m\xE1s tarde.",this.isLoading=!1}});this.subscriptions.add(t)}applyFilters(){let t=[...this.allClaims];this.searchTerm&&(t=t.filter(e=>e.nombre.toLowerCase().includes(this.searchTerm.toLowerCase()))),this.filterStatus&&this.filterStatus!=="Todos"&&(t=t.filter(e=>e.estado===this.filterStatus)),this.selectedExecutiveUid&&(t=t.filter(e=>e.uidEjecutivo===this.selectedExecutiveUid)),this.filteredClaims=t,this.currentPage=1,this.updatePagedClaims(),this.updateDeleteButtonState(),this.masterChecked=this.filteredClaims.every(e=>e.selected)}updatePagedClaims(){let t=(this.currentPage-1)*this.itemsPerPage,e=t+this.itemsPerPage;this.pagedClaims=this.filteredClaims.slice(t,e)}openNewModal(){this.resetNewClaim(),this.showNewModal=!0,console.log("\u{1F4A1} showNewModal es:",this.showNewModal)}closeNewModal(){this.showNewModal=!1}saveNewClaim(){if(!this.newClaim.nombre||!this.newClaim.estado||!this.selectedExecutiveUid){this.alert.showToastError("Por favor, completa todos los campos requeridos (nombre, estado, ejecutivo).","Campos Requeridos");return}this.newClaim.uidEjecutivo=this.selectedExecutiveUid,this.newClaim.id=this.generateUUID(),console.log("\u{1F195} Reclamo preparado para guardar:",this.newClaim),console.log("\u{1F3AF} UID del ejecutivo seleccionado:",this.selectedExecutiveUid),this.isLoading=!0,this.claimsService.createClaim(this.newClaim.uidEjecutivo,this.newClaim).then(()=>{this.alert.success("Nuevo reclamo asignado con \xE9xito."),this.closeNewModal(),this.loadAllClaims(),this.notificationService.sendToUser(this.selectedExecutiveUid,`Se te asign\xF3 un nuevo reclamo: ${this.newClaim.nombre}`,"asignado").then(()=>console.log("\u2705 Notificaci\xF3n enviada al ejecutivo")).catch(t=>console.error("\u274C Error al enviar notificaci\xF3n:",t))}).catch(t=>{console.error("\u274C Error al crear reclamo:",t),this.alert.error("Ocurri\xF3 un error al crear el reclamo.")}).finally(()=>{this.isLoading=!1})}resetNewClaim(){this.newClaim=this.getEmptyClaim(),this.selectedExecutiveUid=""}getEmptyClaim(){return{id:"",nombre:"",tipo:"",total:0,estado:"Pendiente",fecha:new Date().toISOString().split("T")[0],uidEjecutivo:"",selected:!1}}generateUUID(){return crypto.randomUUID()}resetData(){this.searchTerm="",this.filterStatus="Todos",this.selectedExecutiveUid="",this.currentPage=1,this.loadAllClaims(),this.alert.showToastInfo("Filtros restablecidos y datos recargados.","Informaci\xF3n")}toggleMasterCheckbox(){this.masterChecked=!this.masterChecked,this.filteredClaims.forEach(t=>t.selected=this.masterChecked),this.updateDeleteButtonState()}toggleClaimSelection(t){t.selected=!t.selected,this.masterChecked=this.filteredClaims.every(e=>e.selected),this.updateDeleteButtonState()}hasSelectedClaims(){return this.filteredClaims.some(t=>t.selected)}updateDeleteButtonState(){this.showDeleteButton=this.hasSelectedClaims()}deleteSelectedClaims(){return y(this,null,function*(){let t=this.filteredClaims.filter(o=>o.selected);if(t.length===0){this.alert.showToastInfo("No hay reclamos seleccionados para eliminar.","Informaci\xF3n");return}if(!(yield this.alert.confirm("\xBFEst\xE1s seguro?","Esta acci\xF3n eliminar\xE1 los reclamos seleccionados de forma permanente.")))return;this.isLoading=!0;let l=[];for(let o of t)o.uidEjecutivo&&o.id?l.push(this.claimsService.deleteClaim(o.uidEjecutivo,o.id).catch(d=>{console.error(`\u274C Error al eliminar el reclamo ${o.id}:`,d),this.alert.error(`No se pudo eliminar el reclamo: ${o.nombre}`)})):console.warn("\u26A0\uFE0F No se pudo eliminar el reclamo (falta UID o ID):",o);Promise.all(l).then(()=>{this.alert.success("\u2705 Reclamos seleccionados eliminados con \xE9xito."),this.loadAllClaims()}).catch(o=>{console.error("Un error inesperado ocurri\xF3 durante la eliminaci\xF3n masiva:",o)}).finally(()=>{this.isLoading=!1,this.masterChecked=!1,this.updateDeleteButtonState()})})}getExecutiveName(t){if(!t)return"N/A";let e=this.executives.find(l=>l.uid===t);return e?`${e.name||""} ${e.last_name||""}`.trim():"N/A"}viewClaim(t){console.log("\u{1F441}\uFE0F Ver reclamo:",t),this.selectedClaim=I({},t),this.isViewOnly=!0,this.showModal=!0,this.alert.showToastInfo(`Viendo reclamo: ${t.nombre}`,"Ver Reclamo")}editClaim(t){console.log("\u270F\uFE0F Editar reclamo button editClaim:",t),this.selectedClaim=I({},t),this.isViewOnly=!1,this.showModal=!0,this.alert.showToastInfo(`Editando reclamo: ${t.nombre}`,"Editar Reclamo")}openViewEditModal(t,e=!0){console.log("Abriendo modal para ver/editar reclamo:",t),this.selectedClaim=I({},t),this.isViewOnly=!0,this.isEditing=!1,this.showModal=!0,this.alert.showToastInfo(`Viendo reclamo: ${t.nombre}`,"Ver Reclamo")}enableEdit(){this.isViewOnly=!1,this.isEditing=!0,this.alert.showToastInfo("Modo de edici\xF3n activado.","Editar Reclamo")}toggleEditMode(){this.isViewOnly=!this.isViewOnly,this.alert.showToastInfo(this.isViewOnly?"Modo de visualizaci\xF3n activado.":"Modo de edici\xF3n activado.","Cambio de Modo")}saveChanges(){console.log("\u{1F4BE} Guardando cambios para el reclamo:",this.selectedClaim),this.selectedClaim&&this.selectedClaim.uidEjecutivo&&this.selectedClaim.id?this.claimsService.updateClaim(this.selectedClaim.uidEjecutivo,this.selectedClaim).then(()=>{if(this.alert.showToastSuccess("\u2705 Reclamo actualizado con \xE9xito.","OK!"),this.loadAllClaims(),this.cancelEdit(),this.selectedClaim&&this.selectedClaim.uidEjecutivo){let t=this.selectedClaim.uidEjecutivo;this.notificationService.sendToUser(t,`Se ha actualizado el reclamo #${this.selectedClaim.id}`,"editado").then(()=>console.log("\u2705 Notificaci\xF3n de edici\xF3n enviada al ejecutivo")).catch(e=>console.error("\u274C Error al enviar notificaci\xF3n de edici\xF3n:",e))}else console.warn("\u26A0\uFE0F Reclamo sin ejecutivo asignado. No se env\xEDa notificaci\xF3n.")}).catch(t=>{console.error("\u274C Error al actualizar el reclamo:",t),this.alert.showToastError("Ocurri\xF3 un error al actualizar el reclamo.","Error")}):this.alert.showToastError("No hay reclamo seleccionado o faltan datos para actualizar.","Error")}cancelEdit(){this.selectedClaim=null,this.showModal=!1,this.isEditing=!1,this.isViewOnly=!1}saveEditedClaim(){this.selectedClaim&&this.selectedClaim.uidEjecutivo&&this.selectedClaim.id?this.claimsService.updateClaim(this.selectedClaim.uidEjecutivo,this.selectedClaim).then(()=>{this.alert.success("\u2705 Reclamo actualizado con \xE9xito."),this.loadAllClaims(),this.cancelEdit()}).catch(t=>{console.error("\u274C Error al actualizar el reclamo:",t),this.alert.error("Ocurri\xF3 un error al actualizar el reclamo.")}):this.alert.showToastError("No hay reclamo seleccionado o faltan datos para actualizar.","Error")}cancelNewClaim(){this.newClaim=this.getEmptyClaim(),this.showNewModal=!1}getTotalPages(){return Math.ceil(this.filteredClaims.length/this.itemsPerPage)}getPagesArray(){return Array.from({length:this.getTotalPages()},(t,e)=>e+1)}onPageChange(t){t>=1&&t<=this.getTotalPages()&&(this.currentPage=t,this.updatePagedClaims())}onItemsPerPageChange(t){let e=t.target;this.itemsPerPage=Number(e.value),this.currentPage=1,this.updatePagedClaims()}deleteClaim(t){let e=this.allClaims.find(l=>l.id===t);e&&e.uidEjecutivo?confirm("\xBFEst\xE1s seguro de que quieres eliminar este reclamo?")&&this.claimsService.deleteClaim(e.uidEjecutivo,t).then(()=>{this.alert.success("\u2705 Reclamo eliminado con \xE9xito."),this.loadAllClaims()}).catch(l=>{console.error("\u274C Error al eliminar el reclamo:",l),this.alert.error("Ocurri\xF3 un error al eliminar el reclamo.")}):this.alert.showToastError("No se pudo encontrar el reclamo para eliminar o falta el UID del ejecutivo.","Error")}ngOnDestroy(){this.subscriptions.unsubscribe()}updateMetrics(){let t=this.claims.length,e=this.claims.filter(S=>S.estado==="Iniciado").length,l=this.claims.filter(S=>S.estado==="Pendiente").length,o=this.claims.filter(S=>S.estado==="Cancelado").length,d=this.claims.filter(S=>S.estado==="Cerrado").length;console.log("\u{1F4CA} M\xE9tricas actualizadas:"),console.log("\u27A1\uFE0F Total:",t),console.log("\u{1F7E6} Iniciados:",e),console.log("\u{1F7E8} Pendientes:",l),console.log("\u{1F7E5} Cancelados:",o),console.log("\u{1F7E9} Cerrados:",d),this.metrics=[{icon:"bi-folder-check",count:t,label:"Total de Reclamos",color:"primary",footerText:"Todos los reclamos registrados",trendIcon:"bi-bar-chart"},{icon:"bi-play-circle",count:e,label:"Iniciados",color:"info",footerText:"Reclamos en inicio",trendIcon:"bi-graph-up"},{icon:"bi-hourglass-split",count:l,label:"Pendientes",color:"warning",footerText:"Requieren atenci\xF3n",trendIcon:"bi-exclamation-circle"},{icon:"bi-x-circle",count:o,label:"Cancelados",color:"danger",footerText:"No continuaron",trendIcon:"bi-x-circle"},{icon:"bi-check-circle",count:d,label:"Cerrados",color:"success",footerText:"Reclamos resueltos",trendIcon:"bi-check-circle"}]}static \u0275fac=function(e){return new(e||a)(h(ue),h(B),h(W),h(R),h(ae))};static \u0275cmp=M({type:a,selectors:[["app-admin-claims"]],decls:28,vars:10,consts:[[1,"row"],[1,"col-12","text-start","grid-margin"],[1,"card"],[1,"card-body"],[1,"col-12"],["aria-label","breadcrumb",1,""],[1,"breadcrumb","mb-0"],[1,"breadcrumb-item"],[3,"routerLink"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-12","grid-margin"],["class","d-flex justify-content-center align-items-center","style","height: 200px;",4,"ngIf"],[4,"ngIf"],[1,"row","grid-margin"],["class","col-md-6 col-xl-3 my-3",4,"ngFor","ngForOf"],["class","col-12 mt-3",4,"ngIf"],["class","row",4,"ngIf"],["class","modal fade show d-block","style","background-color: rgba(0,0,0,0.4); z-index: 1050;",4,"ngIf"],[1,"d-flex","justify-content-center","align-items-center",2,"height","200px"],["role","status",1,"spinner-border"],[1,"visually-hidden"],[1,"d-flex","align-items-center","mb-4","mb-lg-0","py-4"],[1,"position-relative","d-inline-block"],["alt","Profile Picture","width","100","height","100",1,"border","border-5","border-primary","rounded-circle","profile-pic","border-opacity-25","object-fit-cover",3,"src"],[1,"ms-3","text-start"],[1,"m-0","p-0"],[1,"m-0","p-0","text-muted"],[1,"badge","badge-type","badge-outline-info"],[1,"col-md-6","col-xl-3","my-3"],[3,"icon","count","label","color","footerText","trendIcon"],[1,"col-12","mt-3"],["role","alert",1,"alert","alert-danger","text-center"],[1,"col-6"],[1,"h3","m-0"],[1,"mb-0"],[1,"col-6","d-flex","justify-content-end","align-items-center"],[1,"btn","btn-full","--primary","m-1","btn-sm",3,"click"],[1,"bi","bi-plus-circle","me-1"],[1,"btn","btn-full","--danger","m-1","btn-sm",3,"click","disabled"],[1,"bi","bi-trash","me-1"],[1,"col-12","py-3"],[1,"row","g-3","align-items-center"],[1,"col-md-3"],["for","searchTerm",1,"form-label","visually-hidden"],["type","text","id","searchTerm","placeholder","Buscar por nombre...",1,"form-control",3,"ngModelChange","input","ngModel"],["for","filterStatus",1,"form-label","visually-hidden"],["id","filterStatus",1,"form-select",3,"ngModelChange","change","ngModel"],["value","Todos"],["value","Iniciado"],["value","Pendiente"],["value","Cancelado"],["value","Cerrado"],["for","selectedExecutive",1,"form-label","visually-hidden"],["id","selectedExecutive",1,"form-select",3,"ngModelChange","change","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"btn","btn-full","--primary","m-1","w-100",3,"click"],[1,"bi","bi-arrow-counterclockwise","me-1"],[1,"table-responsive"],[1,"table","table-light","table-hover","align-middle"],["type","checkbox",1,"form-check-input",3,"change","checked"],[4,"ngFor","ngForOf"],[1,"co-sm-12","col-md-6","py-3","d-flex","justify-content-start","align-items-center"],[1,"form-select","form-select-sm","d-inline-block","w-auto","ms-2",3,"change","ngModel"],[3,"value"],[1,"mx-2"],[1,"co-sm-12","col-md-6","py-3","d-flex","justify-content-end","align-items-center"],["aria-label","Page navigation"],[1,"pagination","mb-0"],[1,"page-item"],[1,"page-link",3,"click"],["class","page-item",3,"active",4,"ngFor","ngForOf"],["colspan","7",1,"text-center","text-muted","py-4"],[1,"badge",3,"ngClass"],[1,"btn","btn-full","--info","m-1","btn-sm",3,"click"],[1,"bi","bi-eye-fill"],[1,"modal","fade","show","d-block",2,"background-color","rgba(0,0,0,0.4)","z-index","1050"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["class","badge bg-secondary ms-2",4,"ngIf"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],["class","row g-3",4,"ngIf"],["class","alert alert-warning",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-full","--danger","m-1",3,"click"],["type","button","class","btn btn-full --primary m-1",3,"click",4,"ngIf"],["type","button","class","btn btn-full --success m-1",3,"disabled","click",4,"ngIf"],[1,"badge","bg-secondary","ms-2"],[1,"row","g-3"],[1,"col-md-6"],[1,"form-label"],["name","selectedNombre","required","",1,"form-control",3,"ngModelChange","ngModel","disabled"],["name","selectedTipo",1,"form-control",3,"ngModelChange","ngModel","disabled"],["name","selectedEstado",1,"form-select",3,"ngModelChange","ngModel","disabled"],["name","selectedFecha","type","date",1,"form-control",3,"ngModelChange","ngModel","disabled"],["name","selectedEjecutivo",1,"form-select",3,"ngModelChange","ngModel","disabled"],["name","selectedDetail","rows","3",1,"form-control",3,"ngModelChange","ngModel","disabled"],[1,"alert","alert-warning"],["type","button",1,"btn","btn-full","--primary","m-1",3,"click"],[1,"bi","bi-pencil-square","me-1"],["type","button",1,"btn","btn-full","--success","m-1",3,"click","disabled"],[1,"bi","bi-save","me-1"],[1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content","rounded","shadow-lg"],["name","newNombre","required","",1,"form-control",3,"ngModelChange","ngModel"],["name","newTipo",1,"form-control",3,"ngModelChange","ngModel"],["name","newDetail","rows","3",1,"form-control",3,"ngModelChange","ngModel"],["name","newFecha","type","date",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-md-12"],["name","ejecutivo","required","",1,"form-select",3,"ngModelChange","ngModel"],["disabled","","selected","",3,"ngValue"],[1,"btn","btn-full","--primary","m-1",3,"click"],[1,"btn","btn-full","--success","m-1",3,"click"]],template:function(e,l){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",0)(5,"div",4)(6,"nav",5)(7,"ol",6)(8,"li",7)(9,"a",8),r(10,"Home"),i()(),n(11,"li",9),r(12,"Mis reclamos"),i()()()()()()()()(),n(13,"div",0)(14,"div",10),f(15,Ze,4,0,"div",11)(16,et,16,3,"div",12),i()(),n(17,"div",13),f(18,tt,2,6,"div",14),i(),n(19,"div",0)(20,"div",10)(21,"div",2)(22,"div",3),f(23,it,4,0,"div",11)(24,nt,3,1,"div",15)(25,st,90,20,"div",16),i()()()(),f(26,vt,16,6,"div",17)(27,ht,37,7,"div",17)),e&2&&(s(9),c("routerLink",ie(9,Je)),s(6),c("ngIf",l.isLoading),s(),c("ngIf",!l.isLoading&&l.userData),s(2),c("ngForOf",l.metrics),s(5),c("ngIf",l.isLoading),s(),c("ngIf",l.errorMessage),s(),c("ngIf",!l.isLoading&&!l.errorMessage),s(),c("ngIf",l.showModal),s(),c("ngIf",l.showNewModal))},dependencies:[P,U,j,V,Y,H,K,X,z,$,q,G,Fe,le,ke,pe,L,re,O],encapsulation:2})};var Ct=()=>["/dashboard"],_t=(a,t,e,l)=>({"bg-primary":a,"bg-warning text-dark":t,"bg-danger":e,"bg-success":l}),be=a=>({"is-invalid":a});function xt(a,t){a&1&&(n(0,"div",18)(1,"div",19)(2,"span",20),r(3,"Loading..."),i()()())}function bt(a,t){if(a&1&&(n(0,"div")(1,"div",2)(2,"div",3)(3,"div",21)(4,"div",22),v(5,"img",23),i(),n(6,"div",24)(7,"h2",25),r(8),i(),n(9,"h6",25),r(10,"Bienvenido a tu aplicaci\xF3n"),i(),n(11,"p",26),r(12,"Este es tu panel de control, aqu\xED puedes administrar tus tareas, ver estad\xEDsticas y m\xE1s."),i(),n(13,"p",26)(14,"span",27),r(15),i()()()()()()()),a&2){let e=m();s(5),c("src",e.userData.photoURL||e.imageDefault,te),s(3),w("Hola, ",e.userData.name||"Invitado"),s(7),C(e.userData.rol||"Desconocido")}}function Et(a,t){if(a&1&&(n(0,"div",28),v(1,"app-card-metric",29),i()),a&2){let e=t.$implicit;s(),c("icon",e.icon)("count",e.count)("label",e.label)("color",e.color)("footerText",e.footerText)("trendIcon",e.trendIcon)}}function St(a,t){a&1&&(n(0,"div",18)(1,"div",19)(2,"span",20),r(3,"Loading..."),i()()())}function wt(a,t){if(a&1&&(n(0,"div",30)(1,"div",31),r(2),i()()),a&2){let e=m();s(2),w(" ",e.errorMessage," ")}}function yt(a,t){a&1&&(n(0,"div",30)(1,"div",32),r(2," No tienes reclamos asignados. "),i()())}function Tt(a,t){a&1&&(n(0,"tr")(1,"td",68),r(2,"No se encontraron reclamos con los filtros aplicados."),i()())}function It(a,t){if(a&1){let e=_();n(0,"tr")(1,"td")(2,"input",58),g("change",function(){let o=u(e).$implicit,d=m(2);return p(d.toggleClaimSelection(o))}),i()(),n(3,"td"),r(4),i(),n(5,"td"),r(6),i(),n(7,"td"),r(8),D(9,"date"),i(),n(10,"td")(11,"span",69),r(12),i()(),n(13,"td")(14,"button",70),g("click",function(){let o=u(e).$implicit,d=m(2);return p(d.viewClaim(o))}),v(15,"i",71),r(16," Ver / Editar "),i()()()}if(a&2){let e=t.$implicit;s(2),c("checked",e.selected),s(2),C(e.nombre),s(2),C(e.tipo),s(2),C(N(9,6,e.fecha,"shortDate")),s(3),c("ngClass",oe(9,_t,e.estado==="Iniciado",e.estado==="Pendiente",e.estado==="Cancelado",e.estado==="Cerrado")),s(),w(" ",e.estado," ")}}function Mt(a,t){if(a&1){let e=_();n(0,"li",65)(1,"a",66),g("click",function(){let o=u(e).$implicit,d=m(2);return p(d.onPageChange(o))}),r(2),i()()}if(a&2){let e=t.$implicit,l=m(2);T("active",e===l.currentPage),s(2),C(e)}}function Vt(a,t){if(a&1){let e=_();n(0,"div",0)(1,"div",33)(2,"h2",34),r(3,"Administraci\xF3n de Reclamaciones"),i(),n(4,"p",35),r(5,"Aqu\xED puedes gestionar todas las reclamaciones asignadas a ti."),i()(),n(6,"div",36)(7,"button",37),g("click",function(){u(e);let o=m();return p(o.deleteSelectedClaims())}),v(8,"i",38),r(9," Eliminar Seleccionados "),i()(),n(10,"div",39)(11,"div",40)(12,"div",41)(13,"label",42),r(14,"Buscar por Nombre"),i(),n(15,"input",43),E("ngModelChange",function(o){u(e);let d=m();return b(d.searchTerm,o)||(d.searchTerm=o),p(o)}),g("input",function(){u(e);let o=m();return p(o.applyFilters())}),i(),n(16,"small",44),r(17),i()(),n(18,"div",45)(19,"label",46),r(20,"Filtrar por Estado"),i(),n(21,"select",47),E("ngModelChange",function(o){u(e);let d=m();return b(d.filterStatus,o)||(d.filterStatus=o),p(o)}),g("change",function(){u(e);let o=m();return p(o.applyFilters())}),n(22,"option",48),r(23,"Todos los Estados"),i(),n(24,"option",49),r(25,"Iniciado"),i(),n(26,"option",50),r(27,"Pendiente"),i(),n(28,"option",51),r(29,"Cancelado"),i(),n(30,"option",52),r(31,"Cerrado"),i()()(),n(32,"div",53)(33,"button",54),g("click",function(){u(e);let o=m();return o.searchTerm="",o.filterStatus="Todos",p(o.applyFilters())}),v(34,"i",55),r(35," Limpiar Filtros "),i()()()(),n(36,"div",30)(37,"div",56)(38,"table",57)(39,"thead")(40,"tr")(41,"th")(42,"input",58),g("change",function(){u(e);let o=m();return p(o.toggleMasterCheckbox())}),i()(),n(43,"th"),r(44,"Nombre"),i(),n(45,"th"),r(46,"Tipo"),i(),n(47,"th"),r(48,"Fecha"),i(),n(49,"th"),r(50,"Estado"),i(),n(51,"th"),r(52,"Acciones"),i()()(),n(53,"tbody"),f(54,Tt,3,0,"tr",12)(55,It,17,14,"tr",59),i()()()(),n(56,"div",60)(57,"div"),r(58," Elementos por p\xE1gina: "),n(59,"select",61),g("change",function(o){u(e);let d=m();return p(d.onItemsPerPageChange(o))}),n(60,"option",62),r(61,"10"),i(),n(62,"option",62),r(63,"25"),i(),n(64,"option",62),r(65,"50"),i(),n(66,"option",62),r(67,"100"),i()()(),n(68,"nav",63)(69,"ul",64)(70,"li",65)(71,"a",66),g("click",function(){u(e);let o=m();return p(o.onPageChange(o.currentPage-1))}),r(72,"Anterior"),i()(),f(73,Mt,3,3,"li",67),n(74,"li",65)(75,"a",66),g("click",function(){u(e);let o=m();return p(o.onPageChange(o.currentPage+1))}),r(76,"Siguiente"),i()()()(),n(77,"div"),r(78),i()()()}if(a&2){let e=m();s(7),c("disabled",!e.showDeleteButton),s(8),x("ngModel",e.searchTerm),s(2),C(e.searchTerm),s(4),x("ngModel",e.filterStatus),s(21),c("checked",e.masterChecked),s(12),c("ngIf",e.pagedClaims.length===0),s(),c("ngForOf",e.pagedClaims),s(4),c("ngModel",e.itemsPerPage),s(),c("value",10),s(2),c("value",25),s(2),c("value",50),s(2),c("value",100),s(4),T("disabled",e.currentPage===1),s(3),c("ngForOf",e.getPagesArray()),s(),T("disabled",e.currentPage===e.getTotalPages()),s(4),F(" P\xE1gina ",e.currentPage," de ",e.getTotalPages()," ")}}function Pt(a,t){a&1&&(n(0,"div",93),r(1," El nombre es requerido. "),i())}function kt(a,t){a&1&&(n(0,"div",93),r(1," El estado es requerido. "),i())}function Ft(a,t){a&1&&(n(0,"div",93),r(1," La fecha es requerida. "),i())}function At(a,t){if(a&1){let e=_();n(0,"button",94),g("click",function(){u(e);let o=m(2);return p(o.enableEdit())}),v(1,"i",95),r(2," Habilitar Edici\xF3n "),i()}}function Dt(a,t){if(a&1){let e=_();n(0,"button",96),g("click",function(){u(e);let o=m(2);return p(o.saveChanges())}),v(1,"i",97),r(2," Guardar Cambios "),i()}if(a&2){let e=m(2);c("disabled",!e.isEditing||e.claimForm.invalid)}}function Nt(a,t){if(a&1){let e=_();n(0,"div",72)(1,"div",73)(2,"div",74)(3,"div",75)(4,"h5",76),r(5,"Detalle de Reclamo "),n(6,"span",77),r(7),i()(),n(8,"button",78),g("click",function(){u(e);let o=m();return p(o.cancelEdit())}),i()(),n(9,"div",79)(10,"form",80)(11,"div",81)(12,"label",82),r(13,"Nombre"),i(),v(14,"input",83),f(15,Pt,2,0,"div",84),i(),n(16,"div",81)(17,"label",82),r(18,"Tipo (Asunto)"),i(),v(19,"input",85),i(),n(20,"div",4)(21,"label",82),r(22,"Descripci\xF3n"),i(),v(23,"textarea",86),i(),n(24,"div",81)(25,"label",82),r(26,"Estado"),i(),n(27,"select",87)(28,"option",49),r(29,"Iniciado"),i(),n(30,"option",50),r(31,"Pendiente"),i(),n(32,"option",51),r(33,"Cancelado"),i(),n(34,"option",52),r(35,"Cerrado"),i()(),f(36,kt,2,0,"div",84),i(),n(37,"div",81)(38,"label",82),r(39,"Fecha"),i(),v(40,"input",88),f(41,Ft,2,0,"div",84),i()()(),n(42,"div",89)(43,"button",90),g("click",function(){u(e);let o=m();return p(o.cancelEdit())}),r(44,"Cerrar"),i(),f(45,At,3,0,"button",91)(46,Dt,3,1,"button",92),i()()()()}if(a&2){let e=m();s(7),C(e.selectedClaim==null?null:e.selectedClaim.id),s(3),c("formGroup",e.claimForm),s(4),c("ngClass",A(10,be,e.getFormControl("nombre").invalid&&e.getFormControl("nombre").touched)),s(),c("ngIf",e.getFormControl("nombre").invalid&&e.getFormControl("nombre").touched),s(12),c("ngClass",A(12,be,e.getFormControl("estado").invalid&&e.getFormControl("estado").touched)),s(9),c("ngIf",e.getFormControl("estado").invalid&&e.getFormControl("estado").touched),s(4),c("ngClass",A(14,be,e.getFormControl("fecha").invalid&&e.getFormControl("fecha").touched)),s(),c("ngIf",e.getFormControl("fecha").invalid&&e.getFormControl("fecha").touched),s(4),c("ngIf",!e.isEditing),s(),c("ngIf",e.isEditing)}}var he=class a{constructor(t,e,l,o,d,S,Bt){this.fb=t;this.claimsService=e;this.authService=l;this.alert=o;this.userService=d;this.mockService=S;this.notificationService=Bt}executiveClaims=[];filteredClaims=[];userData=null;isLoading=!0;errorMessage=null;claimForm;isEditing=!1;showModal=!1;isViewOnly=!0;subscriptions=new ee;selectedClaim=null;currentUserUid=null;TEST_EXECUTIVE_UID="KVDf8PfHEWMdic0SQPcxFMizoBf2";searchTerm="";filterStatus="Todos";masterChecked=!1;showDeleteButton=!1;currentPage=1;itemsPerPage=10;pagedClaims=[];imagePath="assets/images/isotipo-webmain.svg";imageDefault="https://maxuber79.github.io/gsaforce/assets/images/face28.jpg";metrics=[{label:"Total Claims",icon:"bi-list",count:0,color:"primary",footerText:"Actualizado en tiempo real",trendIcon:"bi-arrow-repeat"},{label:"Pendientes",icon:"bi-hourglass",count:0,color:"warning",footerText:"Revisar cuanto antes",trendIcon:"bi-hourglass-split"},{label:"Cerrados",icon:"bi-check-circle",count:0,color:"success",footerText:"Resueltos con \xE9xito",trendIcon:"bi-check2"},{label:"Cancelados",icon:"bi-x-circle",count:0,color:"danger",footerText:"No continuaron",trendIcon:"bi-x"}];ngOnInit(){this.initializeForm(),this.authService.getAuthState().subscribe(t=>{t&&(this.currentUserUid=t.uid,console.log(`\u{1F510} Usuario autenticado: ${t.email} (UID: ${this.currentUserUid})`),this.userService.getUserData(this.currentUserUid).subscribe({next:e=>{this.userData=e||null,console.log("%c<<< userData | executive >>>","background: #198754; color: #fff;",this.userData),this.userData&&this.userData.uid?(this.claimsService.getUserClaims(this.userData.uid).subscribe(l=>{this.updateMetrics(l),console.log("%c<<< claims para m\xE9tricas >>>","background: #198754; color: #fff;",l)}),this.loadExecutiveClaims(this.userData.uid)):console.warn("\u26A0\uFE0F No se encontr\xF3 userData.uid, no se cargan reclamos")},error:e=>{console.error("\u274C Error al obtener datos del usuario:",e)}}))})}updateMetrics(t){let e=t.length,l=t.filter(S=>S.estado==="Pendiente"||S.estado==="Iniciado").length,o=t.filter(S=>S.estado==="Cerrado").length,d=t.filter(S=>S.estado==="Cancelado").length;this.metrics[0].count=e,this.metrics[1].count=l,this.metrics[2].count=o,this.metrics[3].count=d}initializeForm(t){this.claimForm=this.fb.group({id:[t?.id||null],nombre:[t?.nombre||"",k.required],tipo:[t?.tipo||""],detail:[t?.detail||""],estado:[t?.estado||"Pendiente",k.required],fecha:[t?.fecha||new Date().toISOString().split("T")[0],k.required],uidEjecutivo:[t?.uidEjecutivo||this.TEST_EXECUTIVE_UID]})}loadExecutiveClaims(t){this.isLoading=!0,this.errorMessage=null;let e=this.claimsService.getClaimsByUid(t).pipe(J(l=>l.map(o=>Z(I({},o),{selected:!1}))),we(l=>(console.error("\u274C Error al cargar reclamos del ejecutivo:",l),this.errorMessage="No se pudieron cargar los reclamos. Int\xE9ntalo de nuevo m\xE1s tarde.",this.isLoading=!1,Ee))).subscribe({next:l=>{this.executiveClaims=l,this.isLoading=!1,console.log("\u2705 Reclamos del ejecutivo cargados:",this.executiveClaims),this.updateDeleteButtonState(),this.masterChecked=!1,this.applyFilters()}});this.subscriptions.add(e)}applyFilters(){let t=[...this.executiveClaims];this.searchTerm&&(t=t.filter(e=>e.nombre.toLowerCase().includes(this.searchTerm.toLowerCase()))),this.filterStatus&&this.filterStatus!=="Todos"&&(t=t.filter(e=>e.estado===this.filterStatus)),this.filteredClaims=t,this.currentPage=1,this.updatePagedClaims()}viewClaim(t){this.selectedClaim=I({},t),this.initializeForm(this.selectedClaim),this.isEditing=!1,this.claimForm.disable(),this.showModal=!0,console.log("\u{1F50D} Reclamo seleccionado para ver/editar:",this.selectedClaim)}enableEdit(){this.isEditing=!0,this.claimForm.enable(),this.claimForm.get("id")?.disable(),this.claimForm.get("uidEjecutivo")?.disable()}saveChanges(){if(this.isEditing&&this.claimForm.valid&&this.selectedClaim){this.isLoading=!0;let t=I({id:this.selectedClaim.id,uidEjecutivo:this.selectedClaim.uidEjecutivo||this.TEST_EXECUTIVE_UID},this.claimForm.getRawValue());this.claimsService.updateClaim(t.uidEjecutivo,t).then(()=>{this.alert.success("\u2705 Reclamo actualizado con \xE9xito."),this.notificationService.sendToAdmins(`El ejecutivo <strong>${this.userData?.user_name}</strong> ha <strong>modificado</strong> el reclamo <strong>#${t.id}</strong>.`,"admin-alert"),this.cancelEdit(),this.loadExecutiveClaims(t.uidEjecutivo)}).catch(e=>{console.error("\u274C Error actualizando reclamo:",e),this.alert.error("Ocurri\xF3 un error al actualizar el reclamo. Int\xE9ntalo de nuevo."),this.isLoading=!1})}else this.isEditing?(this.claimForm.markAllAsTouched(),this.alert.showToastError("Por favor, completa todos los campos requeridos.","Formulario inv\xE1lido")):this.alert.showToastInfo('Haz clic en "Habilitar Edici\xF3n" para modificar el reclamo.',"Modo de Solo Lectura")}cancelEdit(){this.showModal=!1,this.selectedClaim=null,this.claimForm.reset(),this.errorMessage=null,this.isEditing=!1}getFormControl(t){return this.claimForm.get(t)}toggleMasterCheckbox(){this.masterChecked=!this.masterChecked,this.executiveClaims.forEach(t=>t.selected=this.masterChecked),this.updateDeleteButtonState()}toggleClaimSelection(t){t.selected=!t.selected,this.masterChecked=this.executiveClaims.every(e=>e.selected),this.updateDeleteButtonState()}hasSelectedClaims(){return this.executiveClaims.some(t=>t.selected)}updateDeleteButtonState(){this.showDeleteButton=this.hasSelectedClaims()}deleteSelectedClaims(){return y(this,null,function*(){let t=this.executiveClaims.filter(o=>o.selected);if(t.length===0){this.alert.showToastInfo("No hay reclamos seleccionados para eliminar.","Informaci\xF3n");return}if(!(yield this.alert.confirm("\xBFEst\xE1s seguro?","Esta acci\xF3n eliminar\xE1 los reclamos seleccionados de forma permanente.")))return;this.isLoading=!0;let l=[];for(let o of t)o.uidEjecutivo&&o.id?l.push(this.claimsService.deleteClaim(o.uidEjecutivo,o.id).catch(d=>{console.error(`\u274C Error al eliminar el reclamo ${o.id}:`,d),this.alert.error(`No se pudo eliminar el reclamo: ${o.nombre}`)})):console.warn("\u26A0\uFE0F No se pudo eliminar el reclamo (falta UID o ID):",o);Promise.all(l).then(()=>{this.alert.success("\u2705 Reclamos seleccionados eliminados con \xE9xito."),this.currentUserUid&&this.loadExecutiveClaims(this.currentUserUid)}).catch(o=>{console.error("Un error inesperado ocurri\xF3 durante la eliminaci\xF3n masiva:",o)}).finally(()=>{this.isLoading=!1,this.masterChecked=!1,this.updateDeleteButtonState()})})}updatePagedClaims(){let t=(this.currentPage-1)*this.itemsPerPage,e=t+this.itemsPerPage;this.pagedClaims=this.filteredClaims.slice(t,e)}getTotalPages(){return Math.ceil(this.filteredClaims.length/this.itemsPerPage)}getPagesArray(){return Array.from({length:this.getTotalPages()},(t,e)=>e+1)}onPageChange(t){t>=1&&t<=this.getTotalPages()&&(this.currentPage=t,this.updatePagedClaims())}onItemsPerPageChange(t){let e=t.target;this.itemsPerPage=Number(e.value),this.currentPage=1,this.updatePagedClaims()}ngOnDestroy(){this.subscriptions.unsubscribe()}static \u0275fac=function(e){return new(e||a)(h(de),h(ue),h(R),h(W),h(B),h(De),h(ae))};static \u0275cmp=M({type:a,selectors:[["app-executive-claims"]],decls:28,vars:10,consts:[[1,"row"],[1,"col-12","text-start","grid-margin"],[1,"card"],[1,"card-body"],[1,"col-12"],["aria-label","breadcrumb",1,""],[1,"breadcrumb","mb-0"],[1,"breadcrumb-item"],[3,"routerLink"],["aria-current","page",1,"breadcrumb-item","active"],[1,"col-12","grid-margin"],["class","d-flex justify-content-center align-items-center","style","height: 200px;",4,"ngIf"],[4,"ngIf"],[1,"row","grid-margin"],["class","col-md-6 col-xl-3 my-3 ",4,"ngFor","ngForOf"],["class","col-12 mt-3",4,"ngIf"],["class","row",4,"ngIf"],["class","modal fade show d-block","style","background-color: rgba(0,0,0,0.4); z-index: 1050;",4,"ngIf"],[1,"d-flex","justify-content-center","align-items-center",2,"height","200px"],["role","status",1,"spinner-border"],[1,"visually-hidden"],[1,"d-flex","align-items-center","mb-4","mb-lg-0","py-4"],[1,"position-relative","d-inline-block"],["alt","Profile Picture","width","100","height","100",1,"border","border-5","border-primary","rounded-circle","profile-pic","border-opacity-25","object-fit-cover",3,"src"],[1,"ms-3","text-start"],[1,"m-0","p-0"],[1,"m-0","p-0","text-muted"],[1,"badge","badge-type","badge-outline-info"],[1,"col-md-6","col-xl-3","my-3"],[3,"icon","count","label","color","footerText","trendIcon"],[1,"col-12","mt-3"],["role","alert",1,"alert","alert-danger","text-center"],["role","alert",1,"alert","alert-info","text-center"],[1,"col-6"],[1,"h3","mb-3"],[1,"mb-0"],[1,"col-6","text-end"],[1,"btn","btn-full","--danger","m-1","btn-sm",3,"click","disabled"],[1,"bi","bi-trash","me-1"],[1,"col-12","my-3"],[1,"row","g-3","align-items-center"],[1,"col-md-5"],["for","searchTerm",1,"form-label","visually-hidden"],["type","text","id","searchTerm","placeholder","Buscar por nombre...",1,"form-control",3,"ngModelChange","input","ngModel"],[1,"form-text","text-muted"],[1,"col-md-4"],["for","filterStatus",1,"form-label","visually-hidden"],["id","filterStatus",1,"form-select",3,"ngModelChange","change","ngModel"],["value","Todos"],["value","Iniciado"],["value","Pendiente"],["value","Cancelado"],["value","Cerrado"],[1,"col-md-3"],[1,"btn","btn-secondary","w-100",3,"click"],[1,"bi","bi-arrow-counterclockwise","me-1"],[1,"table-responsive"],[1,"table","table-light","table-hover","align-middle"],["type","checkbox",1,"form-check-input",3,"change","checked"],[4,"ngFor","ngForOf"],[1,"col-12","d-flex","justify-content-between","align-items-center","mt-3"],[1,"form-select","form-select-sm","d-inline-block","w-auto","ms-2",3,"change","ngModel"],[3,"value"],["aria-label","Page navigation"],[1,"pagination","mb-0"],[1,"page-item"],[1,"page-link",3,"click"],["class","page-item",3,"active",4,"ngFor","ngForOf"],["colspan","6",1,"text-center","text-muted","py-4"],[1,"badge",3,"ngClass"],[1,"btn","btn-full","--secondary","m-1","btn-sm",3,"click"],[1,"bi","bi-eye"],[1,"modal","fade","show","d-block",2,"background-color","rgba(0,0,0,0.4)","z-index","1050"],[1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content","rounded","shadow-lg"],[1,"modal-header"],[1,"modal-title"],[1,"badge","badge-full-secondary"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[1,"row","g-3",3,"formGroup"],[1,"col-md-6"],[1,"form-label"],["formControlName","nombre",1,"form-control",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["formControlName","tipo",1,"form-control"],["formControlName","detail","rows","3",1,"form-control"],["formControlName","estado",1,"form-select",3,"ngClass"],["formControlName","fecha","type","date",1,"form-control",3,"ngClass"],[1,"modal-footer"],["type","button",1,"btn","btn-full","--warning","m-1",3,"click"],["type","button","class","btn btn-full --primary m-1",3,"click",4,"ngIf"],["type","button","class","btn btn-full --success m-1",3,"disabled","click",4,"ngIf"],[1,"invalid-feedback"],["type","button",1,"btn","btn-full","--primary","m-1",3,"click"],[1,"bi","bi-pencil-square","me-1"],["type","button",1,"btn","btn-full","--success","m-1",3,"click","disabled"],[1,"bi","bi-save","me-1"]],template:function(e,l){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",0)(5,"div",4)(6,"nav",5)(7,"ol",6)(8,"li",7)(9,"a",8),r(10,"Home"),i()(),n(11,"li",9),r(12,"Mis reclamos"),i()()()()()()()()(),n(13,"div",0)(14,"div",10),f(15,xt,4,0,"div",11)(16,bt,16,3,"div",12),i()(),n(17,"div",13),f(18,Et,2,6,"div",14),i(),n(19,"div",0)(20,"div",10)(21,"div",2)(22,"div",3),f(23,St,4,0,"div",11)(24,wt,3,1,"div",15)(25,yt,3,0,"div",15)(26,Vt,79,19,"div",16),i()()()(),f(27,Nt,47,16,"div",17)),e&2&&(s(9),c("routerLink",ie(9,Ct)),s(6),c("ngIf",l.isLoading),s(),c("ngIf",!l.isLoading&&l.userData),s(2),c("ngForOf",l.metrics),s(5),c("ngIf",l.isLoading),s(),c("ngIf",l.errorMessage),s(),c("ngIf",!l.isLoading&&l.executiveClaims.length===0&&!l.errorMessage),s(),c("ngIf",!l.isLoading&&l.executiveClaims.length>0&&!l.errorMessage),s(),c("ngIf",l.showModal))},dependencies:[P,U,j,V,Y,H,K,X,z,$,q,G,le,me,se,ce,pe,L,re,O],encapsulation:2})};var Ce=class a{constructor(t){this.http=t;console.log("%c<<< Start CLAIMS DUMMY service >>>","background: #fff3cd; color: #664d03; padding: 2px 5px;")}jsonUrl="assets/data/claims-expanded.json";getClaimsByUser(t){return this.http.get(this.jsonUrl).pipe(J(e=>e.users[t]?.claims||[]))}getAllClaims(){return this.http.get(this.jsonUrl).pipe(J(t=>Object.values(t.users).flatMap(o=>o.claims||[])))}static \u0275fac=function(e){return new(e||a)(Te(Me))};static \u0275prov=ye({token:a,factory:a.\u0275fac,providedIn:"root"})};function jt(a,t){a&1&&(n(0,"div",5)(1,"div",6)(2,"span",7),r(3,"Cargando rol..."),i()()())}function Ot(a,t){a&1&&(n(0,"app-admin-claims")(1,"h2"),r(2,"Admin Claims"),i(),n(3,"p"),r(4,"Here you can manage admin claims."),i()())}function Lt(a,t){a&1&&(n(0,"app-executive-claims")(1,"h2"),r(2,"Executive Claims"),i(),n(3,"p"),r(4,"Here you can manage executive claims."),i()())}function Rt(a,t){a&1&&(n(0,"div",8),r(1," No se pudo determinar tu rol. Contacta al administrador. "),i())}var Q=class a{constructor(t,e){this.userService=t;this.claimsDummyService=e}role=null;showAdmin=!1;showExecutive=!1;isLoading=!0;ngOnInit(){this.userService.getCurrentUserRole().subscribe(t=>{this.isLoading=!1,console.log("\u{1F9EA} Rol recibido desde el servicio:",t),this.role=t,t==="Administrador"?(this.showAdmin=!0,this.isLoading=!1):t==="Ejecutivo"?this.showExecutive=!0:console.warn("\u26A0\uFE0F Rol desconocido o no asignado")}),this.claimsDummyService.getAllClaims().subscribe(t=>{console.log("\u{1F4C4} Reclamos de todos los usuarios:",t)}),this.claimsDummyService.getClaimsByUser("0FnJKfeUI2T73kBGO5GCdlpUs6W2").subscribe({next:t=>{console.log("\u{1F4C4} Reclamos del usuario:",t)},error:t=>{console.error("\u274C Error al obtener los reclamos:",t)}})}static \u0275fac=function(e){return new(e||a)(h(B),h(Ce))};static \u0275cmp=M({type:a,selectors:[["app-claims-router"]],decls:7,vars:4,consts:[[1,"row"],[1,"col-12"],["class","d-flex justify-content-center align-items-center",4,"ngIf"],[4,"ngIf"],["class","alert alert-danger mt-3",4,"ngIf"],[1,"d-flex","justify-content-center","align-items-center"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"alert","alert-danger","mt-3"]],template:function(e,l){e&1&&(n(0,"div",0)(1,"div",1),f(2,jt,4,0,"div",2),i(),n(3,"div",1),f(4,Ot,5,0,"app-admin-claims",3)(5,Lt,5,0,"app-executive-claims",3)(6,Rt,2,0,"div",4),i()()),e&2&&(s(2),c("ngIf",l.isLoading),s(2),c("ngIf",l.showAdmin),s(),c("ngIf",l.showExecutive),s(),c("ngIf",!l.isLoading&&!l.showAdmin&&!l.showExecutive))},dependencies:[P,V,fe,he],encapsulation:2})};var Di=[{path:"",children:[{path:"",component:Q},{path:"claims",component:Q},{path:"todo",component:ge},{path:"admin-users",children:[{path:"",loadComponent:()=>import("./chunk-3XTQA54N.js").then(a=>a.AdminUserManagementComponent)},{path:"edit-role/:uid",loadComponent:()=>import("./chunk-MIIU2WVH.js").then(a=>a.UserRoleEditComponent)},{path:"profile-edit/:uid",loadComponent:()=>import("./chunk-W754TWFJ.js").then(a=>a.ProfileEditComponent)}]},{path:"admin-notifications",loadComponent:()=>import("./chunk-L2LPH2FT.js").then(a=>a.AdminNotificationsComponent)},{path:"analytics",loadComponent:()=>import("./chunk-KX4NW77Y.js").then(a=>a.AnalyticsComponent)},{path:"notifications/:uid",loadComponent:()=>import("./chunk-TAXAIUSJ.js").then(a=>a.NotificationsComponent)},{path:"profile/:uid",loadComponent:()=>import("./chunk-42LWNK32.js").then(a=>a.ProfileViewComponent)},{path:"**",redirectTo:""}]}];export{Di as routes};
